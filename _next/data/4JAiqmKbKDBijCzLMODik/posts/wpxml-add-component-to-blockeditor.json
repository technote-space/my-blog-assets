{"pageProps":{"post":{"id":"wpxml-add-component-to-blockeditor","title":"【Gutenberg】ブロックエディタに任意の要素を追加する","content":"<html><head></head><body><div class=\"toc-wrapper\"><input type=\"checkbox\" class=\"toc-checkbox\" id=\"toc-checkbox-j31ng7trj0\" checked><label class=\"toc-title\" for=\"toc-checkbox-j31ng7trj0\">目次</label><nav class=\"toc\"><ol class=\"toc-level toc-level-1\"><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#基本はreact\">基本はReact</a><ol class=\"toc-level toc-level-2\"><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#コンポーネントを作成\">コンポーネントを作成</a></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#コンポーネントを挿入するためのdom挿入\">コンポーネントを挿入するためのDOM挿入</a></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#コンポーネントを-render\">コンポーネントを render</a></li></ol></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#実装例\">実装例</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#注意\">注意</a></li></ol></nav></div><h2 id=\"基本はreact\">基本はReact<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#基本はreact\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<p>ブロックエディタは React なので、ブロックエディタの持っている情報などを利用するには React を使用したほうがよいです。</p>\n\n<h3 id=\"コンポーネントを作成\">コンポーネントを作成<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#コンポーネントを作成\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>通常通りにコンポーネントを作成します。</p>\n\n<p>data.select などを使用してブロックエディタの情報を利用することも可能です。</p>\n\n<h3 id=\"コンポーネントを挿入するためのdom挿入\">コンポーネントを挿入するためのDOM挿入<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#コンポーネントを挿入するためのdom挿入\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>ブロックエディタの準備完了時に何か動作させるための <em><code>wp.domReady</code></em> を使用してコンポーネント挿入用のDOMを用意します。</p>\n\n<p>エディタのトップの文書ツールあたりに要素を追加したい場合は <em>.edit-post-header-toolbar</em> が利用できます。</p>\n\n<figure class=\"wp-block-image\"><a href=\"https://technote.space/uploads/2019/08/201908191728.png\"><img src=\"https://technote.space/uploads/2019/08/201908191728.png\" alt=\"\" class=\"wp-image-2093\"></a></figure>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #D8DEE9\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">domReady</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #81A1C1\">function</span><span style=\"color: #ECEFF4\">()</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\tdocument</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">querySelector</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">.edit-post-header-toolbar</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">insertAdjacentHTML</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">beforeend</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">&#x3C;div class=\"test\">&#x3C;/div></span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span></code></pre>\n\n<h3 id=\"コンポーネントを-render\">コンポーネントを render<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#コンポーネントを-render\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>前項で作成したコンポーネントを TestComponent とすると、以下のような React 標準の書き方でコンポーネントが表示されるようになります。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #D8DEE9\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9\">element</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">render</span><span style=\"color: #D8DEE9FF\">(</span>\n<span style=\"color: #D8DEE9FF\">  </span><span style=\"color: #81A1C1\">&#x3C;TestComponent</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">/></span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">  document</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">querySelector</span><span style=\"color: #D8DEE9FF\">(</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">test</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">)</span>\n<span style=\"color: #D8DEE9FF\">)</span><span style=\"color: #81A1C1\">;</span></code></pre>\n\n<h2 id=\"実装例\">実装例<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#実装例\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">Fragment</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9\">element</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">render</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9\">element</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #D8DEE9\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">domReady</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #81A1C1\">function</span><span style=\"color: #ECEFF4\">()</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\tdocument</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">querySelector</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">.edit-post-header-toolbar</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">insertAdjacentHTML</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">beforeend</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">&#x3C;div class=\"test\">&#x3C;/div></span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #88C0D0\">render</span><span style=\"color: #D8DEE9FF\">(</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #81A1C1\">&#x3C;Fragment></span>\n<span style=\"color: #D8DEE9FF\">\t\t\tHallo world!</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #81A1C1\">&#x3C;/Fragment></span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t\tdocument</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">querySelector</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">.test</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t)</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span></code></pre>\n\n<figure class=\"wp-block-image\"><a href=\"https://technote.space/uploads/2019/08/201908191747.png\"><img src=\"https://technote.space/uploads/2019/08/201908191747.png\" alt=\"\" class=\"wp-image-2094\"></a></figure>\n\n<h2 id=\"注意\">注意<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#注意\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<p>内部の状態で表示を出し分けしている箇所の場合、一度非表示になった後に再度挿入しなおさないと消えてしまいます。</p>\n\n<p>内部の状態の変化を監視する方法はブロックエディタには用意されています。</p>\n\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Ftechnote.space%2Fwordpress%2Fgutenberg-switch-block-editor?id=blog-card-43o7doh9bo&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-add-component-to-blockeditor%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-43o7doh9bo\"></iframe></div>\n<!-- /wp:paragraph --></body></html>","excerpt":"基本はREACT ブロックエディタは React なので、ブロックエディタの持っている情報などを利用するには React を使用したほうがよいです。 コンポーネントを作成  通常通りにコンポーネントを作成します。  data.select ...","postType":"post","tags":[{"slug":"gutenberg","name":"Gutenberg"}],"thumbnail":"https://technote.space/uploads/2018/12/banner-772x250.jpg","dominantColor":"rgba(111,111,111,1)","createdAt":"2019-08-19T08:59:36.000Z","updatedAt":null},"prev":{"id":"wpxml-composer-scripts","title":"composerのscriptsで作業効率化","excerpt":"コマンドを短縮する いくつかのオプションを付けたコマンドを定義することでコマンドを短縮できます。 例：  定義したコマンドは composer + コマンド名 で実行できます。   複数のコマンドをまとめる  複数のコマンドをまとめて一つの...","postType":"post","tags":[{"slug":"composer","name":"composer"}],"thumbnail":"https://technote.space/uploads/2019/08/logo-composer-transparent.png","createdAt":"2019-08-20T08:08:07.000Z","updatedAt":null},"next":{"id":"wpxml-laravel-dusk-env","title":"【Laravel】Laravel Dusk時に使用される .env ファイル","excerpt":"Laravel Dusk は Laravel で手軽にブラウザテストを行うためのライブラリです。 とても便利なライブラリですが、通常のユニットテストと環境変数ファイルに関する動作が大きく異なっているため注意が必要です。 通常使用される .E...","postType":"post","tags":[{"slug":"dusk","name":"dusk"},{"slug":"laravel","name":"Laravel"}],"thumbnail":"https://technote.space/uploads/2019/08/201908151553.png","createdAt":"2019-08-17T15:42:03.000Z","updatedAt":null},"headerPages":[],"footerPages":[{"label":"About","url":"/pages/wpxml-about/"},{"label":"プライバシーポリシー","url":"/pages/wpxml-privacy-policy/"},{"label":"お問い合わせ","url":"/pages/wpxml-contact/"}]},"__N_SSG":true}