{"pageProps":{"post":{"id":"wpxml-add-dropdown-to-richtext-toolbar","title":"Gutenbergのツールバーにドロップダウンを追加する","content":"<html><head></head><body><div class=\"toc-wrapper\"><input type=\"checkbox\" class=\"toc-checkbox\" id=\"toc-checkbox-1dkq0371tc\" checked><label class=\"toc-title\" for=\"toc-checkbox-1dkq0371tc\">目次</label><nav class=\"toc\"><ol class=\"toc-level toc-level-1\"><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#blockformatcontrols\">BlockFormatControls</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#ドロップダウンを追加する\">ドロップダウンを追加する</a><ol class=\"toc-level toc-level-2\"><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#方針\">方針</a></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#実装１\">実装１</a><ol class=\"toc-level toc-level-3\"><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#constantjs\">constant.js</a></li><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#components\">components</a></li><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#utils\">utils</a></li><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#indexjs\">index.js</a></li></ol></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#動作確認\">動作確認</a></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#実装２\">実装２</a><ol class=\"toc-level toc-level-3\"><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#install\">install</a></li><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#indexjs-1\">index.js</a></li></ol></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#動作確認-1\">動作確認</a></li></ol></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#まとめ\">まとめ</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#今回のコード例を含むリポジトリ\">今回のコード例を含むリポジトリ</a></li></ol></nav></div><p>Gutenberg（ブロックエディタ）のツールバーにボタンを追加する方法は以前紹介しました。</p>\n\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Ftechnote.space%2Fwordpress%2Fadd-button-to-gutenberg?id=blog-card-vdmplt07vu&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-add-dropdown-to-richtext-toolbar%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-vdmplt07vu\"></iframe></div>\n\n<p>ただ、この方法の場合はドロップダウンでまとめることはできません。</p>\n\n<p>Gutenberg プラグイン v5.3 または WordPress v5.2 からはデフォルトのボタンとともにドロップダウンにまとまるようになりましたが、独自のボタンだけでまとめたいこともあるでしょう。</p>\n\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Ftechnote.space%2Fwordpress%2Fgutenberg-5-3-richtext-dropdown?id=blog-card-d8fuue1061&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-add-dropdown-to-richtext-toolbar%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-d8fuue1061\"></iframe></div>\n\n<p>ここでは独自のドロップダウンに追加する方法を紹介します。</p>\n\n<figure class=\"wp-block-image\"><a href=\"https://technote.space/uploads/2019/04/04162218.png\"><img src=\"https://technote.space/uploads/2019/04/04162218.png\" alt=\"\" class=\"wp-image-1506\"></a></figure>\n\n<h2 id=\"blockformatcontrols\">BlockFormatControls<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#blockformatcontrols\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<p>ボタンなどを追加できる場所はいくつか用意されています。</p>\n\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Ftechnote.space%2Fwordpress%2Fslot-fill?id=blog-card-cpuj14j96u&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-add-dropdown-to-richtext-toolbar%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-cpuj14j96u\"></iframe></div>\n\n<p>ツールバーへ追加するには『<strong>BlockControls</strong>』または『<strong>BlockFormatControls</strong>』を使用します。</p>\n\n<p>デフォルトのツールバーボタンよりも後ろに追加する場合は『<strong>BlockFormatControls</strong>』を使用します。</p>\n\n<p><em>registerFormatType</em> は RichText.ToolbarControls Slot を利用するための Fill を生成するようにプログラムされています。</p>\n\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Fgithub.com%2FWordPress%2Fgutenberg%2Fblob%2Fmaster%2Fpackages%2Fblock-editor%2Fsrc%2Fcomponents%2Frich-text%2Ftoolbar-button.js?id=blog-card-fkap09pnsh&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-add-dropdown-to-richtext-toolbar%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-fkap09pnsh\"></iframe></div>\n\n<p>『BlockControls』や『BlockFormatControls』はそれぞれの Slot を利用するための Fill となるので、通常のコンポーネントを利用するのと同じ様に使用できます。</p>\n\n<h2 id=\"ドロップダウンを追加する\">ドロップダウンを追加する<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#ドロップダウンを追加する\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<p>ここからは実際にフォーマットの付け外しを行う複数のボタンをひとつのドロップダウンにまとめる方法を解説します。</p>\n\n<h3 id=\"方針\">方針<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#方針\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p><em>registerFormatType</em> は 使用するフォーマットの情報 (title(フォーマット名)や tag名、class名) とそれの付け外しの手段 (edit) を登録します。</p>\n\n<p>この edit で通常は <em>RichTextToolbarButton</em> を使用し、押されたときに <em>toggleFormat</em> によってフォーマットの付け外しが行われるボタンを追加します。</p>\n\n<p>ただ実際は <em>RichTextToolbarButton</em> は <em>RichText.ToolbarControls</em> という Fill に ToolbarButton を登録する関数で、これ自体はボタンの実体ではありません。</p>\n\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Fgithub.com%2FWordPress%2Fgutenberg%2Fblob%2Frelease%2F5.6%2Fpackages%2Fblock-editor%2Fsrc%2Fcomponents%2Frich-text%2Ftoolbar-button.js%23L7?id=blog-card-4nkq0eilrv&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-add-dropdown-to-richtext-toolbar%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-4nkq0eilrv\"></iframe></div>\n\n<p>その後 <em>RichText.ToolbarControls</em> という Slot で登録されたボタンが取り出され、DropdownMenu に渡されて表示されます。</p>\n\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Fgithub.com%2FWordPress%2Fgutenberg%2Fblob%2Frelease%2F5.6%2Fpackages%2Fblock-editor%2Fsrc%2Fcomponents%2Frich-text%2Fformat-toolbar%2Findex.js%23L21?id=blog-card-7e19nk3jsh&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-add-dropdown-to-richtext-toolbar%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-7e19nk3jsh\"></iframe></div>\n\n<p>これと同じような仕組みを用意することで簡単にドロップダウン化することが可能です。</p>\n\n<p>Slot と Fill の詳細は次の記事を参考にしてください。</p>\n\n<figure class=\"wp-block-embed-wordpress wp-block-embed is-type-wp-embed is-provider-technote\"><div class=\"wp-block-embed__wrapper\">\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Ftechnote.space%2Fwordpress%2Fslot-fill?id=blog-card-cpuj14j96u&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-add-dropdown-to-richtext-toolbar%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-cpuj14j96u\"></iframe></div>\n</div></figure>\n\n<h3 id=\"実装１\">実装１<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#実装１\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>webpack でのビルド環境などの準備の説明は省きます。</p>\n\n<figure class=\"wp-block-image\"><img src=\"https://technote.space/uploads/2019/05/201905131454.png\" alt=\"\" class=\"wp-image-1703\"></figure>\n\n<h4 id=\"constantjs\">constant.js<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#constantjs\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>使用する定数を定義します。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #81A1C1\">export</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">PLUGIN_NAME</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">my-dropdown</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span></code></pre>\n\n<h4 id=\"components\">components<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#components\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>いくつかのコンポーネントを用意します。</p>\n\n<h5 id=\"componentsmy-dropdown-controlsjs\">components/my-dropdown-controls.js<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#componentsmy-dropdown-controlsjs\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h5>\n\n<p>Slot と Fill を利用するためのヘルパーです。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">createSlotFill</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">components</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">Fill</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">Slot</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">createSlotFill</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">MyDropdownControls</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">MyDropdownControls</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">Fill</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9\">MyDropdownControls</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9\">Slot</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">Slot</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">export</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">default</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">MyDropdownControls</span><span style=\"color: #81A1C1\">;</span></code></pre>\n\n<h5 id=\"componentsmy-dropdownjs\">components/my-dropdown.js<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#componentsmy-dropdownjs\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h5>\n\n<p><em>MyDropdownControls</em> で登録される Fill を使用して <em>DropdownMenu</em> を生成します。</p>\n\n<p>ツールバーの Slot を利用するための <em>BlockFormatControls</em> でラップすることでツールバーに表示されます。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">BlockFormatControls</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9\">editor</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">Toolbar</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">DropdownMenu</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">components</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">MyDropdownControls</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">./my-dropdown-controls</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">MyDropdown</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">()</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=></span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">&#x3C;BlockFormatControls></span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">&#x3C;div</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">className</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">editor-format-toolbar block-editor-format-toolbar</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #81A1C1\">></span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #81A1C1\">&#x3C;Toolbar></span>\n<span style=\"color: #D8DEE9FF\">\t\t\t</span><span style=\"color: #81A1C1\">&#x3C;MyDropdownControls.Slot></span>\n<span style=\"color: #D8DEE9FF\">\t\t\t\t</span><span style=\"color: #81A1C1\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">fills</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=></span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">&#x3C;DropdownMenu</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t\t\t</span><span style=\"color: #8FBCBB\">icon</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">admin-customizer</span><span style=\"color: #ECEFF4\">'</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t\t\t</span><span style=\"color: #8FBCBB\">position</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">bottom left</span><span style=\"color: #ECEFF4\">\"</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t\t\t</span><span style=\"color: #8FBCBB\">label</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">dropdown</span><span style=\"color: #ECEFF4\">'</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t\t\t</span><span style=\"color: #8FBCBB\">controls</span><span style=\"color: #81A1C1\">={</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">fills</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">map</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">props</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">]</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=></span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">props</span><span style=\"color: #D8DEE9FF\"> ) </span><span style=\"color: #81A1C1\">}</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t\t</span><span style=\"color: #81A1C1\">/></span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">}</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t</span><span style=\"color: #81A1C1\">&#x3C;/MyDropdownControls.Slot></span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #81A1C1\">&#x3C;/Toolbar></span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">&#x3C;/div></span>\n<span style=\"color: #81A1C1\">&#x3C;/BlockFormatControls>;</span>\n\n<span style=\"color: #81A1C1\">export</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">default</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">MyDropdown</span><span style=\"color: #81A1C1\">;</span></code></pre>\n\n<p>ここでは <em>icon</em> を <em>'admin-customizer'</em>  とハードコーディングしていますが、これがツールバーに表示されるアイコンになるので適宜変更します。</p>\n\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Fdeveloper.wordpress.org%2Fresource%2Fdashicons%2F?id=blog-card-hgkhnjo338&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-add-dropdown-to-richtext-toolbar%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-hgkhnjo338\"></iframe></div>\n\n<p>他の設定も含めて色々変更できるようにしておくと便利かもしれません。</p>\n\n<h5 id=\"componentsindexjs\">components/index.js<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#componentsindexjs\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h5>\n\n<p>import の記述を減らしたり利用できる components を把握するためだけに用意しています。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">MyDropdown</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">./my-dropdown</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">MyDropdownControls</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">./my-dropdown-controls</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">export</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">MyDropdown</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">MyDropdownControls</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #81A1C1\">;</span></code></pre>\n\n<h4 id=\"utils\">utils<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#utils\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>いくつかの便利関数を用意します。</p>\n\n<h5 id=\"utilsrich-textjs\">utils/rich-text.js<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#utilsrich-textjs\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h5>\n\n<p>リッチテキスト用の関数を用意します。</p>\n\n<p>ここでは <em>registerFormatType</em> で渡す引数の生成ヘルパーを用意しています。</p>\n\n<p>フォーマット名 (name) と component生成関数 (create)、 追加した順番 (index) を渡すと<em>registerFormatType</em> に必要な引数を返します。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">Fragment</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9\">element</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">PLUGIN_NAME</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">../constant</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">MyDropdown</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">MyDropdownControls</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">../components</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #4C566A\">/**</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {string} </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #4C566A\"> name</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {number} </span><span style=\"color: #D8DEE9\">index</span><span style=\"color: #4C566A\"> index</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {function} </span><span style=\"color: #D8DEE9\">create</span><span style=\"color: #4C566A\"> create component function</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {object} </span><span style=\"color: #D8DEE9\">setting</span><span style=\"color: #4C566A\"> setting</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@returns</span><span style=\"color: #4C566A\"> {array} setting</span>\n<span style=\"color: #4C566A\"> */</span>\n<span style=\"color: #81A1C1\">export</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">getRichTextSetting</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">create</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">setting</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">},</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">index</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=></span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">formatName</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> PLUGIN_NAME </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">/</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">component</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">args</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=></span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">&#x3C;MyDropdownControls></span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #81A1C1\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">create</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">args</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">formatName</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> ) </span><span style=\"color: #81A1C1\">}</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">&#x3C;/MyDropdownControls>;</span>\n\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #8FBCBB\">setting</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">title </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">setting</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">title </span><span style=\"color: #81A1C1\">||</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #8FBCBB\">setting</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">tagName </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">setting</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">tagName </span><span style=\"color: #81A1C1\">||</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">span</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #8FBCBB\">setting</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">className </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">setting</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">className </span><span style=\"color: #81A1C1\">||</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #8FBCBB\">setting</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">edit</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">args</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=></span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #81A1C1\">if</span><span style=\"color: #D8DEE9FF\"> ( </span><span style=\"color: #81A1C1\">!</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">index</span><span style=\"color: #D8DEE9FF\"> ) </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t</span><span style=\"color: #81A1C1\">return</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">&#x3C;Fragment></span>\n<span style=\"color: #D8DEE9FF\">\t\t\t\t</span><span style=\"color: #81A1C1\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">component</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #D8DEE9\">args</span><span style=\"color: #D8DEE9FF\"> ) </span><span style=\"color: #81A1C1\">}</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t\t</span><span style=\"color: #81A1C1\">&#x3C;MyDropdown/></span>\n<span style=\"color: #D8DEE9FF\">\t\t\t</span><span style=\"color: #81A1C1\">&#x3C;/Fragment>;</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #ECEFF4\">}</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #81A1C1\">return</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">component</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #D8DEE9\">args</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">return</span><span style=\"color: #D8DEE9FF\"> [ </span><span style=\"color: #D8DEE9\">formatName</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">setting</span><span style=\"color: #D8DEE9FF\"> ]</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #ECEFF4\">}</span><span style=\"color: #81A1C1\">;</span></code></pre>\n\n<p>肝となるのは以下の個所です。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #81A1C1\">if</span><span style=\"color: #D8DEE9FF\"> ( </span><span style=\"color: #81A1C1\">!</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">index</span><span style=\"color: #D8DEE9FF\"> ) </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">...</span>\n<span style=\"color: #ECEFF4\">}</span></code></pre>\n\n<p>それぞれのフォーマットで <em>MyDropdownControls</em> を使用して Fill を登録しますが、<span class=\"double-underline\">どれか一つのフォーマットでドロップダウンを追加で生成</span>します。</p>\n\n<p>ここでは <em>! index</em> 、つまり最初に追加したフォーマットの <em>edit</em> の時にそれを行っています。</p>\n\n<p>これは一番最後や途中でも問題はありません。</p>\n\n<h5 id=\"utilstoolbar-buttonjs\">utils/toolbar-button.js<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#utilstoolbar-buttonjs\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h5>\n\n<p>ツールバーボタン生成用のヘルパーを用意します。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">toggleFormat</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9\">richText</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">ToolbarButton</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">components</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #4C566A\">/**</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {object} </span><span style=\"color: #D8DEE9\">args</span><span style=\"color: #4C566A\"> args</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {string} </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #4C566A\"> name</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {string} </span><span style=\"color: #D8DEE9\">formatName</span><span style=\"color: #4C566A\"> format name</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@returns</span><span style=\"color: #4C566A\"> {{onClick: onClick, icon: *, title: *, isActive: boolean}} toolbar button properties</span>\n<span style=\"color: #4C566A\"> */</span>\n<span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">getToolbarButtonProps</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">args</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">formatName</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=></span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">return</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #88C0D0\">icon</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">admin-customizer</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #88C0D0\">title</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">&#x3C;</span><span style=\"color: #D8DEE9\">div</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">className</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #81A1C1\">></span>\n<span style=\"color: #D8DEE9FF\">\t\t\t</span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #81A1C1\">&#x3C;/</span><span style=\"color: #D8DEE9\">div</span><span style=\"color: #81A1C1\">></span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #88C0D0\">onClick</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">()</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=></span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t</span><span style=\"color: #8FBCBB\">args</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">onChange</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #88C0D0\">toggleFormat</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #8FBCBB\">args</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">value</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t\t</span><span style=\"color: #88C0D0\">type</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">formatName</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t</span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> ) )</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #ECEFF4\">},</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #88C0D0\">isActive</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">args</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9\">isActive</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #ECEFF4\">}</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #4C566A\">/**</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {object} </span><span style=\"color: #D8DEE9\">args</span><span style=\"color: #4C566A\"> args</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {string} </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #4C566A\"> name</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {string} </span><span style=\"color: #D8DEE9\">formatName</span><span style=\"color: #4C566A\"> format name</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@returns</span><span style=\"color: #4C566A\"> {*} toolbar button</span>\n<span style=\"color: #4C566A\"> */</span>\n<span style=\"color: #81A1C1\">export</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">createToolbarButton</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">args</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">formatName</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=></span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">&#x3C;ToolbarButton</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">...</span><span style=\"color: #88C0D0\">getToolbarButtonProps</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">args</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">formatName</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> ) </span><span style=\"color: #81A1C1\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">/>;</span></code></pre>\n\n<p><em>icon</em> を <em>'admin-customizer' </em> としていますが、これがドロップダウン内で表示されるボタンのアイコンになるので適宜変更します。</p>\n\n<h5 id=\"utilsindexjs\">utils/index.js<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#utilsindexjs\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h5>\n\n<pre class=\"wp-block-code\" style=\"background: #2e3440\"><code style=\"color: undefined\">export { createToolbarButton } from './toolbar-button';\nexport { getRichTextSetting } from './rich-text';</code></pre>\n\n<h4 id=\"indexjs\">index.js<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#indexjs\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>ここまでで追加されたヘルパーを使用して実際に使用するフォーマットを登録します。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">registerFormatType</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9\">richText</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">createToolbarButton</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">getRichTextSetting</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">./utils</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #D8DEE9FF\">[</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #88C0D0\">name</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">test1</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #88C0D0\">create</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">createToolbarButton</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">},</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #88C0D0\">name</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">test2</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #88C0D0\">create</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">createToolbarButton</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">},</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #88C0D0\">name</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">test3</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #88C0D0\">create</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">createToolbarButton</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">},</span>\n<span style=\"color: #D8DEE9FF\">]</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">forEach</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">create</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">setting</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">},</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">index</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=></span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">registerFormatType</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #81A1C1\">...</span><span style=\"color: #88C0D0\">getRichTextSetting</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">create</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">setting</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">},</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">index</span><span style=\"color: #D8DEE9FF\"> ) ) )</span><span style=\"color: #81A1C1\">;</span></code></pre>\n\n<p>ここでは３つのフォーマットを作成しました。</p>\n\n<h3 id=\"動作確認\">動作確認<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#動作確認\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>ビルドしたものを <em>wp_enqueue_script</em> で読み込ませます。</p>\n\n<ul><li>wp-components</li><li>wp-editor</li><li>wp-element</li><li>wp-rich-text</li></ul>\n\n<p>に依存していることを忘れないようにしてください。</p>\n\n<figure class=\"wp-block-image\"><img src=\"https://technote.space/uploads/2019/05/201905131528.png\" alt=\"\" class=\"wp-image-1704\"></figure>\n\n<p>複数の名前の Fill と Slot を用意して使用すれば複数のドロップダウンを追加することも可能です。</p>\n\n<h3 id=\"実装２\">実装２<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#実装２\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>実装１の Fill と Slot と同じ方法でライブラリ化したのでそれを使用してみます。</p>\n\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Fwww.npmjs.com%2Fpackage%2F%40technote-space%2Fregister-grouped-format-type?id=blog-card-dl99tufkl8&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-add-dropdown-to-richtext-toolbar%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-dl99tufkl8\"></iframe></div>\n\n<figure class=\"wp-block-image\"><img src=\"https://technote.space/uploads/2019/05/201905131615.png\" alt=\"\" class=\"wp-image-1705\"></figure>\n\n<h4 id=\"install\">install<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#install\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<pre class=\"wp-block-code\" style=\"background: #2e3440\"><code style=\"color: undefined\">npm install --save @technote-space/register-grouped-format-type</code></pre>\n\n<p><em>import</em> して使用します。</p>\n\n<pre class=\"wp-block-code\" style=\"background: #2e3440\"><code style=\"color: undefined\">import { Common, RichText } from '@technote-space/register-grouped-format-type';</code></pre>\n\n<pre class=\"wp-block-code\" style=\"background: #2e3440\"><code style=\"color: undefined\">const { registerFormatTypeGroup, registerGroupedFormatType } = RichText;\nconst { getToolbarButtonProps } = Common.Helpers;</code></pre>\n\n<h5 id=\"richtext\"><em>RichText</em><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#richtext\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h5>\n\n<h6 id=\"registerformattypegroup\"><em>registerFormatTypeGroup</em><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#registerformattypegroup\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h6>\n\n<p>この関数はグループ化されたフォーマットの登録に使用します。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #4C566A\">/**</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {string} </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #4C566A\"> name</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {string} </span><span style=\"color: #D8DEE9\">title</span><span style=\"color: #4C566A\"> title</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {string} </span><span style=\"color: #D8DEE9\">tagName</span><span style=\"color: #4C566A\"> tag name</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {string} </span><span style=\"color: #D8DEE9\">className</span><span style=\"color: #4C566A\"> class name</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {function} </span><span style=\"color: #D8DEE9\">create</span><span style=\"color: #4C566A\"> create component function</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {function} </span><span style=\"color: #D8DEE9\">createInspector</span><span style=\"color: #4C566A\"> create inspector component function</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {string} </span><span style=\"color: #D8DEE9\">group</span><span style=\"color: #4C566A\"> group</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {string} </span><span style=\"color: #D8DEE9\">inspectorGroup</span><span style=\"color: #4C566A\"> inspector group</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {object} </span><span style=\"color: #D8DEE9\">settings</span><span style=\"color: #4C566A\"> settings</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@return</span><span style=\"color: #4C566A\"> {object|null} registered settings</span>\n<span style=\"color: #4C566A\"> */</span>\n<span style=\"color: #88C0D0\">registerGroupedFormatType</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">    title = </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">    tagName = 'span'</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">    className = </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #D8DEE9\">create</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #D8DEE9\">createInspector</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">    group = </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">    inspectorGroup = </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #81A1C1\">...</span><span style=\"color: #D8DEE9\">settings</span>\n<span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> )</span></code></pre>\n\n<h6 id=\"registergroupedformattype\"><em>registerGroupedFormatType</em><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#registergroupedformattype\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h6>\n\n<p>この関数はグループの設定の登録に使用します。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #4C566A\">/**</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {string} </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #4C566A\"> group name</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {object} </span><span style=\"color: #D8DEE9\">setting</span><span style=\"color: #4C566A\"> setting</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@returns</span><span style=\"color: #4C566A\"> {object} registered setting</span>\n<span style=\"color: #4C566A\"> */</span>\n<span style=\"color: #88C0D0\">registerFormatTypeGroup</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">setting</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{}</span><span style=\"color: #D8DEE9FF\"> )</span></code></pre>\n\n<p>特に設定されなかった項目はデフォルト値が使用されます。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #D8DEE9\">icon</span><span style=\"color: #D8DEE9FF\">: </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">admin-customizer</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #D8DEE9\">position</span><span style=\"color: #D8DEE9FF\">: </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">bottom left</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #D8DEE9\">label</span><span style=\"color: #D8DEE9FF\">: </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #D8DEE9\">menuLabel</span><span style=\"color: #D8DEE9FF\">: </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #D8DEE9\">className</span><span style=\"color: #D8DEE9FF\">: </span><span style=\"color: #81A1C1\">undefined</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #D8DEE9\">menuClassName</span><span style=\"color: #D8DEE9FF\">: </span><span style=\"color: #81A1C1\">undefined</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #D8DEE9\">inspectorSettings</span><span style=\"color: #D8DEE9FF\">: </span><span style=\"color: #ECEFF4\">{},</span>\n<span style=\"color: #ECEFF4\">}</span></code></pre>\n\n<h5 id=\"commonhelpers\"><em>Common.Helpers</em><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#commonhelpers\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h5>\n\n<h6 id=\"gettoolbarbuttonprops\"><em>getToolbarButtonProps</em><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#gettoolbarbuttonprops\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h6>\n\n<p>この関数は <em>registerGroupedFormatType</em> に必要な引数の生成を容易にします。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #4C566A\">/**</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {string} </span><span style=\"color: #D8DEE9\">group</span><span style=\"color: #4C566A\"> group</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {string} </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #4C566A\"> name</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {*} </span><span style=\"color: #D8DEE9\">icon</span><span style=\"color: #4C566A\"> icon</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@param</span><span style=\"color: #4C566A\"> {object} </span><span style=\"color: #D8DEE9\">optional</span><span style=\"color: #4C566A\"> optional</span>\n<span style=\"color: #4C566A\"> * </span><span style=\"color: #8FBCBB\">@returns</span><span style=\"color: #4C566A\"> {object} props</span>\n<span style=\"color: #4C566A\"> */</span>\n<span style=\"color: #88C0D0\">getToolbarButtonProps</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #D8DEE9\">group</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">name</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">icon</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">optional</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">tooltipClass</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">undefined</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> )</span></code></pre>\n\n<h4 id=\"indexjs-1\">index.js<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#indexjs-1\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>ライブラリによって追加された関数を実際に使用して追加してみます。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">Common</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">RichText</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">@technote-space/register-grouped-format-type</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">registerFormatTypeGroup</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">registerGroupedFormatType</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">RichText</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">getToolbarButtonProps</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">getColorButtonProps</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">getFontSizesButtonProps</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">Common</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9\">Helpers</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #4C566A\">// register format type group setting</span>\n<span style=\"color: #88C0D0\">registerFormatTypeGroup</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">test2</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #88C0D0\">icon</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">admin-network</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #4C566A\">// register grouped format types</span>\n<span style=\"color: #88C0D0\">registerGroupedFormatType</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #88C0D0\">getToolbarButtonProps</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">test1</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">dropdown2-test1</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">admin-customizer</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> ) )</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #88C0D0\">registerGroupedFormatType</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #88C0D0\">getToolbarButtonProps</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">test2</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">dropdown2-test2</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">admin-customizer</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> ) )</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #88C0D0\">registerGroupedFormatType</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #88C0D0\">getToolbarButtonProps</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">test2</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">dropdown2-test3</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">admin-customizer</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> ) )</span><span style=\"color: #81A1C1\">;</span></code></pre>\n\n<p>test1 グループは１つフォーマットを登録、test2 グループ アイコンを変更して２つのフォーマットを登録しました。</p>\n\n<h3 id=\"動作確認-1\">動作確認<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#動作確認-1\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>ビルドしたものを <em>wp_enqueue_script</em> で読み込ませます。</p>\n\n<p>このライブラリは</p>\n\n<ul><li>wp-components</li><li>wp-data</li><li>wp-editor</li><li>wp-element</li><li>wp-rich-text</li><li>wp-url</li><li>lodash</li></ul>\n\n<p>に依存しています。</p>\n\n<figure class=\"wp-block-image\"><a href=\"https://technote.space/uploads/2019/06/201906120148.png\"><img src=\"https://technote.space/uploads/2019/06/201906120148.png\" alt=\"\" class=\"wp-image-1937\"></a></figure>\n\n<p>少ないコードで簡単に追加することができました。</p>\n\n<p>また以下の動作になるように調整されています。</p>\n\n<ul><li>グループに追加した数が２つ未満の場合は通常のボタン表示</li><li>付け外しが無効の場合にボタンを無効化</li></ul>\n\n<h2 id=\"まとめ\">まとめ<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#まとめ\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<p>公式で用意された方法がないため、store を使用する方法など、色々な方法が考えられます。</p>\n\n<p>今回は <em>Slot</em> と <em>Fill</em>  を活用してツールバーボタンのドロップダウン化を実装しましたが、これももっといろいろな使い方ができそうです。</p>\n\n<h2 id=\"今回のコード例を含むリポジトリ\">今回のコード例を含むリポジトリ<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#今回のコード例を含むリポジトリ\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Fgithub.com%2Ftechnote-space%2Fgutenberg-samples?id=blog-card-bgsledub2k&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-add-dropdown-to-richtext-toolbar%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-bgsledub2k\"></iframe></div>\n<!-- /wp:paragraph --></body></html>","excerpt":"Gutenberg（ブロックエディタ）のツールバーにボタンを追加する方法は以前紹介しました。 ただ、この方法の場合はドロップダウンでまとめることはできません。  Gutenberg プラグイン v5.3 または WordPress v5.2...","postType":"post","tags":[{"slug":"gutenberg","name":"Gutenberg"},{"slug":"%e3%83%89%e3%83%ad%e3%83%83%e3%83%97%e3%83%80%e3%82%a6%e3%83%b3","name":"ドロップダウン"}],"thumbnail":"https://technote.space/uploads/2018/12/banner-772x250.jpg","dominantColor":"rgba(111,111,111,1)","createdAt":"2019-04-15T14:08:44.000Z","updatedAt":null},"prev":{"id":"wpxml-hide-blocks-temporarily","title":"Gutenbergのブロックを一時的に隠すプラグインを作成しました","excerpt":"機能 一時的にブロックを非表示にできます。  スタイルを戻すことで表示状態に戻ります。   導入手順   1. 最新版をGitHubからダウンロード     release.zip  2. 「プラグインのアップロード」からインストール   ...","postType":"post","tags":[{"slug":"gutenberg","name":"Gutenberg"}],"thumbnail":"https://technote.space/uploads/2019/04/banner-772x250-1.png","createdAt":"2019-04-28T12:59:39.000Z","updatedAt":null},"next":{"id":"wpxml-yuzo-related-posts-vulnerability","title":"yuzo related posts から学ぶ脆弱性を含むプラグインやテーマの特徴","excerpt":"4/10 ごろから yuzo related posts というプラグインが原因でJavaScriptが注入され、閲覧者が詐欺サイトへ飛ばされるという事例が多く発生しています。 公式ディレクトリに登録されていても安全とは限りません。 公式デ...","postType":"post","tags":[{"slug":"%e3%82%bb%e3%82%ad%e3%83%a5%e3%83%aa%e3%83%86%e3%82%a3","name":"セキュリティ"},{"slug":"%e8%84%86%e5%bc%b1%e6%80%a7","name":"脆弱性"}],"thumbnail":"https://technote.space/uploads/2018/11/computer_virus_backdoor.png","createdAt":"2019-04-11T10:25:06.000Z","updatedAt":null},"headerPages":[],"footerPages":[{"label":"About","url":"/pages/wpxml-about/"},{"label":"プライバシーポリシー","url":"/pages/wpxml-privacy-policy/"},{"label":"お問い合わせ","url":"/pages/wpxml-contact/"}]},"__N_SSG":true}