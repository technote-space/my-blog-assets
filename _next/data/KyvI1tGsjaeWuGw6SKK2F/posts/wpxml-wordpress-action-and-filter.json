{"pageProps":{"post":{"id":"wpxml-wordpress-action-and-filter","title":"WordPress の「アクション」と「フィルタ」を「フック」してプラグインを開発してみる","content":"<html><head></head><body><div class=\"toc-wrapper\"><input type=\"checkbox\" class=\"toc-checkbox\" id=\"toc-checkbox-gtkoh1ca95\" checked><label class=\"toc-title\" for=\"toc-checkbox-gtkoh1ca95\">目次</label><nav class=\"toc\"><ol class=\"toc-level toc-level-1\"><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#最初に\">最初に</a><ol class=\"toc-level toc-level-2\"><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#フックするとは\">「フック」するとは</a></li></ol></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#アクションとフィルタの違い\">アクションとフィルタの違い</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#よく使うアクションとフィルタ\">よく使う「アクション」と「フィルタ」</a><ol class=\"toc-level toc-level-2\"><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#初期化\">初期化</a><ol class=\"toc-level toc-level-3\"><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#init---アクション\">init - アクション</a></li><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#admin_init---アクション\">admin_init - アクション</a></li><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#template_redirect---アクション\">template_redirect - アクション</a></li></ol></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#投稿表示\">投稿表示</a><ol class=\"toc-level toc-level-3\"><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#the_title---フィルタ\">the_title - フィルタ</a></li><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#the_content---フィルタ\">the_content - フィルタ</a></li></ol></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#cssjs登録\">CSS、JS登録</a><ol class=\"toc-level toc-level-3\"><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#wp_enqueue_scripts---アクション\">wp_enqueue_scripts - アクション</a></li><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#wp_enqueue_style\">wp_enqueue_style</a></li></ol></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#投稿保存\">投稿保存</a><ol class=\"toc-level toc-level-3\"><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#save_post---アクション\">save_post - アクション</a></li><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#transition_post_status---アクション\">transition_post_status - アクション</a></li><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#delete_post---アクション\">delete_post - アクション</a></li></ol></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#検索\">検索</a><ol class=\"toc-level toc-level-3\"><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#pre_get_posts---アクション\">pre_get_posts - アクション</a></li></ol></li></ol></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#使用可能なアクションとフィルタの一覧\">使用可能なアクションとフィルタの一覧</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#慣れてきたら\">慣れてきたら</a><ol class=\"toc-level toc-level-2\"><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#処理を追ってみる\">処理を追ってみる</a></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#プラグインの構成を考える\">プラグインの構成を考える</a></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#ショートコードを追加してみる\">ショートコードを追加してみる</a></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#セキュリティ対策\">セキュリティ対策</a><ol class=\"toc-level toc-level-3\"><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#csrf\">CSRF</a></li><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#適切な権限\">適切な権限</a></li><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#入力値の無害化\">入力値の無害化</a></li><li class=\"toc-item toc-item-h4\"><a class=\"toc-link toc-link-h4\" href=\"#出力値の無害化\">出力値の無害化</a></li></ol></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#公開してみる\">公開してみる</a></li></ol></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#まとめ\">まとめ</a></li></ol></nav></div><div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Ftechnote.space%2Fwordpress%2Fminimum-plugin?id=blog-card-vmub8jlkpi&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-wordpress-action-and-filter%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-vmub8jlkpi\"></iframe></div>\n\n<p>の続き</p>\n\n<p>最小限のプラグインが用意出来たので機能を実装していきます。</p>\n\n<h2 id=\"最初に\">最初に<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#最初に\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<p>WordPressのプラグインを作成するうえで絶対に必要な概念として<span class=\"double-underline\">「アクション」と「フィルタ」</span>があります。</p>\n\n<p>WordPressは本体だけで色々な機能が備わっていますが、プログラムの所々で「アクション」と「フィルタ」を適用するプログラムが書かれています。</p>\n\n<ul><li>アクション</li></ul>\n\n<pre class=\"wp-block-preformatted\">do_action( 'admin_notices' );</pre>\n\n<pre class=\"wp-block-preformatted\">do_action_ref_array( 'pre_get_posts', array( &#x26;$this ) );</pre>\n\n<ul><li>フィルタ</li></ul>\n\n<pre class=\"wp-block-preformatted\">$content = apply_filters( 'the_content', $content );</pre>\n\n<pre class=\"wp-block-preformatted\">$where = apply_filters_ref_array( 'posts_where', array( $where, &#x26;$this ) );</pre>\n\n<p>この「アクション」と「フィルタ」は「フック」することができます。</p>\n\n<h3 id=\"フックするとは\">「フック」するとは<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#フックするとは\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>処理を割り込ませて機能を追加することです。</p>\n\n<p>具体的には「do_action」「apply_filters」「do_action_ref_array」「apply_filters_ref_array」が書かれている箇所に処理を挟むことができます。</p>\n\n<p>試しに前回作成したプラグインファイルにプログラムを追加していきます。</p>\n\n<pre class=\"language-php\" style=\"background: #2e3440\"><code class=\"language-php\"><span style=\"color: #ECEFF4\">&#x3C;?php</span>\n<span style=\"color: #4C566A\">/*</span>\n<span style=\"color: #4C566A\">Plugin Name: My</span>\n<span style=\"color: #4C566A\">Description: 自分用プラグイン</span>\n<span style=\"color: #4C566A\">Version: 1.0</span>\n<span style=\"color: #4C566A\">Author: technote</span>\n<span style=\"color: #4C566A\">Author URI: undefined</span>\n<span style=\"color: #4C566A\">License: GPL2</span>\n<span style=\"color: #4C566A\">*/</span>\n\n<span style=\"color: #88C0D0\">add_action</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">admin_notices</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">, </span><span style=\"color: #81A1C1\">function</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">()</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">   </span><span style=\"color: #81A1C1\">echo</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">Hello World!</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span></code></pre>\n\n<figure class=\"wp-block-image\"><a href=\"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/10/201810071853.png\"><img src=\"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/10/201810071853.png\" alt=\"\" class=\"wp-image-406\"></a></figure>\n\n<p>管理画面にアクセスすると上部に「Hello World!」と表示されるはずです。</p>\n\n<p>これは管理画面のヘッダ部分の処理を行うファイル「<em>wp-admin\\admin-header.php</em>」にある</p>\n\n<pre class=\"wp-block-preformatted\">do_action( 'admin_notices' );</pre>\n\n<p>をフックして「Hello World!」を表示するプログラムを割り込ませたためです。</p>\n\n<p>アクションに対しては「add_action」、フィルタに対しては「add_filter」でフックします。</p>\n\n<p><a href=\"https://wpdocs.osdn.jp/関数リファレンス/add_filter\">https://wpdocs.osdn.jp/関数リファレンス/add_filter</a></p>\n\n<p><a href=\"https://wpdocs.osdn.jp/関数リファレンス/add_action\">https://wpdocs.osdn.jp/関数リファレンス/add_action</a></p>\n\n<h2 id=\"アクションとフィルタの違い\">アクションとフィルタの違い<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#アクションとフィルタの違い\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<p>どちらも処理を割り込ませるのですが</p>\n\n<ul><li>アクションは処理を実行</li><li>フィルタは値を変更</li></ul>\n\n<p>という目的で使い分けがされています。</p>\n\n<p>先ほどの例ではアクションを追加して<span class=\"double-underline\">「Hello World!」を表示する処理</span>を実行しました。</p>\n\n<p>一方でフィルタの例として、投稿タイトルを取得する関数「get_the_title」を見てみます。</p>\n\n<p><em>wp-includes/post-template.php</em></p>\n\n<pre class=\"language-php\" style=\"background: #2e3440\"><code class=\"language-php\"><span style=\"color: #D8DEE9FF\">function get_the_title( $post = 0 ) {</span>\n<span style=\"color: #D8DEE9FF\">   $post = get_post( $post );</span>\n\n<span style=\"color: #D8DEE9FF\">   $title = isset( $post->post_title ) ? $post->post_title : '';</span>\n<span style=\"color: #D8DEE9FF\">   $id = isset( $post->ID ) ? $post->ID : 0;</span>\n\n<span style=\"color: #D8DEE9FF\">　　～省略～</span>\n\n<span style=\"color: #D8DEE9FF\">   /**</span>\n<span style=\"color: #D8DEE9FF\">    * Filters the post title.</span>\n<span style=\"color: #D8DEE9FF\">    *</span>\n<span style=\"color: #D8DEE9FF\">    * @since 0.71</span>\n<span style=\"color: #D8DEE9FF\">    *</span>\n<span style=\"color: #D8DEE9FF\">    * @param string $title The post title.</span>\n<span style=\"color: #D8DEE9FF\">    * @param int    $id    The post ID.</span>\n<span style=\"color: #D8DEE9FF\">    */</span>\n<span style=\"color: #D8DEE9FF\">   return apply_filters( 'the_title', $title, $id );</span>\n<span style=\"color: #D8DEE9FF\">}</span></code></pre>\n\n<p>一番最後に「apply_filters」があり、その返り値が「get_the_title」の返り値になっています。</p>\n\n<p>試しにタイトルの最後に必ず「Hello World!」がつくようにしてみましょう。</p>\n\n<pre class=\"language-php\" style=\"background: #2e3440\"><code class=\"language-php\"><span style=\"color: #D8DEE9FF\">add_action( 'the_title', function ( $title, $id ) {</span>\n<span style=\"color: #D8DEE9FF\">   return $title . ' Hello World!';</span>\n<span style=\"color: #D8DEE9FF\">}, 10, 2 );</span></code></pre>\n\n<figure class=\"wp-block-image\"><a href=\"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/10/201810072015.png\"><img src=\"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/10/201810072015-300x124.png\" alt=\"\" class=\"wp-image-410\"></a></figure>\n\n<p>このように<span class=\"double-underline\">「$title」の値を変更する</span>ことができます。</p>\n\n<h2 id=\"よく使うアクションとフィルタ\">よく使う「アクション」と「フィルタ」<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#よく使うアクションとフィルタ\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<h3 id=\"初期化\">初期化<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#初期化\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<h4 id=\"init---アクション\">init - アクション<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#init---アクション\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>WordPressの読み込みが完了し、ヘッダーが送信される前に実行されます。</p>\n\n<p>ユーザ情報は取得できますが、投稿はまだ取得できません。</p>\n\n<p>フロント、管理画面どちらでも実行されます。</p>\n\n<p>プラグインで使用するアクションやフィルタを登録したりします。</p>\n\n<h4 id=\"admin_init---アクション\">admin_init - アクション<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#admin_init---アクション\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>管理画面にてページが表示される前に実行されます。</p>\n\n<p>値を保存したり管理画面用のアクションやフィルタを登録したりします。</p>\n\n<h4 id=\"template_redirect---アクション\">template_redirect - アクション<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#template_redirect---アクション\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>フロント側で使用するアクションやフィルタを登録したりします。</p>\n\n<h3 id=\"投稿表示\">投稿表示<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#投稿表示\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<h4 id=\"the_title---フィルタ\">the_title - フィルタ<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#the_title---フィルタ\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>タイトルを一部変更したりすることができます。</p>\n\n<h4 id=\"the_content---フィルタ\">the_content - フィルタ<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#the_content---フィルタ\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>投稿の一番最後に共通文言を追加したり、投稿内容を書き換えたりすることができます。</p>\n\n<h3 id=\"cssjs登録\">CSS、JS登録<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#cssjs登録\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<h4 id=\"wp_enqueue_scripts---アクション\">wp_enqueue_scripts - アクション<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#wp_enqueue_scripts---アクション\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>JSを登録する際に使用します。</p>\n\n<h4 id=\"wp_enqueue_style\">wp_enqueue_style<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#wp_enqueue_style\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>CSSを登録する際に使用します。</p>\n\n<h3 id=\"投稿保存\">投稿保存<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#投稿保存\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<h4 id=\"save_post---アクション\">save_post - アクション<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#save_post---アクション\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>投稿保存時に処理を追加できます。</p>\n\n<h4 id=\"transition_post_status---アクション\">transition_post_status - アクション<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#transition_post_status---アクション\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>投稿ステータス（公開、下書き等）が変更されたときに処理を追加できます。</p>\n\n<h4 id=\"delete_post---アクション\">delete_post - アクション<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#delete_post---アクション\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>投稿削除時に処理を追加できます。</p>\n\n<h3 id=\"検索\">検索<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#検索\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<h4 id=\"pre_get_posts---アクション\">pre_get_posts - アクション<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#pre_get_posts---アクション\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>検索条件を色々操作することができます。</p>\n\n<h2 id=\"使用可能なアクションとフィルタの一覧\">使用可能なアクションとフィルタの一覧<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#使用可能なアクションとフィルタの一覧\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<p><a href=\"https://wpdocs.osdn.jp/プラグイン_API/アクションフック一覧\">https://wpdocs.osdn.jp/プラグイン_API/アクションフック一覧</a></p>\n\n<p>最初のうちはあまりにも多くのフック可能な箇所に戸惑ってしまうかもしれません。</p>\n\n<h2 id=\"慣れてきたら\">慣れてきたら<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#慣れてきたら\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<h3 id=\"処理を追ってみる\">処理を追ってみる<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#処理を追ってみる\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>プログラムの処理を追って、割り込めるアクションやフィルタがないか探します。</p>\n\n<p><strong>do_action</strong> や <strong>apply_filters</strong> で検索してみるのもよいです。</p>\n\n<p>いろんな箇所にアクションやフィルタがあり、先ほどは戸惑うかもしれないと言ったそのアクションやフィルタの多さが、逆にありがたく感じてくるはずです。</p>\n\n<h3 id=\"プラグインの構成を考える\">プラグインの構成を考える<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#プラグインの構成を考える\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>ここまではプラグインのファイルは一つのPHPファイルのみの場合を解説してきました。</p>\n\n<p>ですがほとんどのプラグインはディレクトリ構造になっていると思います。</p>\n\n<p>プラグインファイル名でディレクトリを作ってその中に適当なPHPファイルを入れても同じようにプラグインと認識してくれます。</p>\n\n<p>さらにPHPファイルから機能ごとに分けた別のPHPファイルを呼び出してあげると見通しがよくなると思います。</p>\n\n<h3 id=\"ショートコードを追加してみる\">ショートコードを追加してみる<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#ショートコードを追加してみる\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>WordPressでは投稿記事内からちょっとしたプログラムを実行してその結果を表示させる機能があります。</p>\n\n<p>例えば</p>\n\n<pre class=\"wp-block-preformatted\">[affitiate id=\"1\"]</pre>\n\n<p>でアフィリエイトタグを挿入できるようにショートコードを作成すれば便利になるでしょう。</p>\n\n<p>ショートコードの詳細は以下を参照してください。</p>\n\n<p><a href=\"https://wpdocs.osdn.jp/ショートコード_API\">https://wpdocs.osdn.jp/ショートコード_API</a></p>\n\n<h3 id=\"セキュリティ対策\">セキュリティ対策<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#セキュリティ対策\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<h4 id=\"csrf\">CSRF<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#csrf\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>主に管理画面で設定値を保存する場合にCSRFの対策をする必要があります。</p>\n\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Fwpdocs.osdn.jp%2FWordPress_Nonce?id=blog-card-sv04a3n9d9&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-wordpress-action-and-filter%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-sv04a3n9d9\"></iframe></div>\n\n<h4 id=\"適切な権限\">適切な権限<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#適切な権限\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>またWordPressには権限という概念があり、あなたの追加した機能は適切な権限のユーザが使用できるものになっている必要があります。</p>\n\n<h4 id=\"入力値の無害化\">入力値の無害化<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#入力値の無害化\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>フォームから送信された値は無害化して使用しましょう。</p>\n\n<p>そのための関数がWordPressには用意されています。</p>\n\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Fdeveloper.wordpress.org%2Fplugins%2Fsecurity%2Fsecuring-input%2F?id=blog-card-iiktb93dv2&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-wordpress-action-and-filter%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-iiktb93dv2\"></iframe></div>\n\n<h4 id=\"出力値の無害化\">出力値の無害化<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#出力値の無害化\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h4>\n\n<p>出力する際も必ず無害化しましょう。</p>\n\n<p>さもなければXSSなどの問題が発生します。</p>\n\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Fdeveloper.wordpress.org%2Fplugins%2Fsecurity%2Fsecuring-output%2F?id=blog-card-rhkhd3ldho&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-wordpress-action-and-filter%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-rhkhd3ldho\"></iframe></div>\n\n<h3 id=\"公開してみる\">公開してみる<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#公開してみる\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>あなたが必要とした機能はきっと他の人も必要としているでしょう。</p>\n\n<p>公式ディレクトということろに登録すると、他の人がプラグイン一覧から検索してプラグインとして利用することができるようになります。</p>\n\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Fwww.islog.jp%2Fentry%2Fwordpress-plugin-release%2F?id=blog-card-jofmbl7nt7&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-wordpress-action-and-filter%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-jofmbl7nt7\"></iframe></div>\n\n<p>基本的にタダで公開することになりますが、最近は仮想通貨による寄付ボタンを設置しているものもありますし、プログラミングスキルを公開することにもなります。</p>\n\n<h2 id=\"まとめ\">まとめ<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#まとめ\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<p>「アクション」と「フィルタ」さえ理解できれば簡単に機能を追加できるようになります。</p>\n\n<p>他にもWordPressにはいろいろな便利な関数が用意されているので、それらも組み合わせると可能性は無限大に広がるでしょう。</p>\n\n<p>まずはちょっとしたものから試してみて、だんだんと追加しながら慣れていくとよいかもしれません。</p>\n\n<p>ぜひ自分でプラグインを作ることに挑戦してみてください。</p>\n<!-- /wp:paragraph --></body></html>","excerpt":"の続き 最小限のプラグインが用意出来たので機能を実装していきます。   最初に  WordPressのプラグインを作成するうえで絶対に必要な概念として「アクション」と「フィルタ」があります。  WordPressは本体だけで色々な機能が備わ...","postType":"post","tags":[{"slug":"wordpress","name":"WordPress"},{"slug":"%e3%82%a2%e3%82%af%e3%82%b7%e3%83%a7%e3%83%b3","name":"アクション"},{"slug":"%e3%83%95%e3%82%a3%e3%83%ab%e3%82%bf","name":"フィルタ"},{"slug":"%e3%83%97%e3%83%a9%e3%82%b0%e3%82%a4%e3%83%b3","name":"プラグイン"},{"slug":"%e9%96%8b%e7%99%ba","name":"開発"}],"thumbnail":"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/07/WordPress-logotype-wmark.png","dominantColor":"rgba(50,55,60,0.18823529411764706)","createdAt":"2018-10-07T12:53:40.000Z","updatedAt":null},"prev":{"id":"wpxml-security-wordpress-related-posts","title":"関連記事プラグイン「WordPress Related Posts」のメリット・デメリット","excerpt":"関連記事の表示はサイトの回遊率を上げるのに非常に有効な手段です。 WordPressでは関連記事を取得する機能はないため、プラグインを利用したり自分で実装する必要があります。 試しに「wordpress 関連記事 プラグイン」で調べてみると...","postType":"post","thumbnail":"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/07/WordPress-logotype-wmark.png","createdAt":"2018-10-11T09:01:19.000Z","updatedAt":null},"next":{"id":"wpxml-wordpress-minimum-plugin","title":"WordPressのプラグインを自分で開発してみる","excerpt":"WordPressを運用しているなら必ずと言ってもいいほどお世話になるプラグイン。 お問い合わせフォームからSEO対策、サイトマップ生成やサイトの高速化まで様々なプラグインがあります。 何かWordPressに欲しい機能があった場合、ネット...","postType":"post","thumbnail":"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/07/WordPress-logotype-wmark.png","createdAt":"2018-10-07T07:43:18.000Z","updatedAt":null},"headerPages":[],"footerPages":[{"label":"About","url":"/pages/wpxml-about/"},{"label":"プライバシーポリシー","url":"/pages/wpxml-privacy-policy/"},{"label":"お問い合わせ","url":"/pages/wpxml-contact/"}]},"__N_SSG":true}