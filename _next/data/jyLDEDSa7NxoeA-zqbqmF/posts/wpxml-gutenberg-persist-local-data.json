{"pageProps":{"post":{"id":"wpxml-gutenberg-persist-local-data","title":"Gutenbergプラグイン用のデータを永続化する","content":"<html><head></head><body><div class=\"toc-wrapper\"><input type=\"checkbox\" class=\"toc-checkbox\" id=\"toc-checkbox-gkdsnkkk5c\" checked><label class=\"toc-title\" for=\"toc-checkbox-gkdsnkkk5c\">目次</label><nav class=\"toc\"><ol class=\"toc-level toc-level-1\"><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#簡単なプラグインの作成\">簡単なプラグインの作成</a><ol class=\"toc-level toc-level-2\"><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#constantjs\">constant.js</a></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#storeconstantjs\">store/constant.js</a></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#storeactionsjs\">store/actions.js</a></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#storereducerjs\">store/reducer.js</a></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#storeselectorsjs\">store/selectors.js</a></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#storeindexjs\">store/index.js</a></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#componentsset-editor-widthjs\">components/set-editor-width.js</a></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#componentsindexjs\">components/index.js</a></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#indexjs\">index.js</a></li></ol></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#動作確認\">動作確認</a></li></ol></nav></div><p>Gutenbergには store による状態管理を簡単に行う方法が用意されています。</p>\n\n<p>さらにその状態をブラウザのローカルストレージに保持するための仕組みもあります。</p>\n\n<p>設定を保存することで、より便利なプラグインを作成することが可能です。</p>\n\n<p>ここではその使用方法を紹介します。</p>\n\n<h2 id=\"簡単なプラグインの作成\">簡単なプラグインの作成<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#簡単なプラグインの作成\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<p>エディタの幅を設定するプラグインを作成してみます。</p>\n\n<figure class=\"wp-block-image\"><a href=\"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2019/05/201905222340.gif\"><img src=\"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2019/05/201905222340.gif\" alt=\"\" class=\"wp-image-1751\"></a></figure>\n\n<h3 id=\"constantjs\"><em>constant.js</em><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#constantjs\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>プラグインで使用する定数を定義します。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #81A1C1\">export</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">PLUGIN_NAME</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">test-plugin</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span></code></pre>\n\n<h3 id=\"storeconstantjs\"><em>store/constant.js</em><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#storeconstantjs\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>store で使用する定数を定義します。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">PLUGIN_NAME</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">../constant</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">export</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">STORE_NAME</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> PLUGIN_NAME</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #81A1C1\">export</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">INITIALIZE</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">@@</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #D8DEE9FF\"> PLUGIN_NAME </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">/INITIALIZE</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #81A1C1\">export</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">SET_WIDTH</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">@@</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #D8DEE9FF\"> PLUGIN_NAME </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">/SET_WIDTH</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span></code></pre>\n\n<h3 id=\"storeactionsjs\"><em>store/actions.js</em><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#storeactionsjs\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>store の actions を追加します。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">INITIALIZE</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">SET_WIDTH</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">./constant</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">export</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">function</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">initialize</span><span style=\"color: #ECEFF4\">()</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">return</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #88C0D0\">type</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> INITIALIZE</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #ECEFF4\">}</span>\n\n<span style=\"color: #81A1C1\">export</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">function</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">setWidth</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">width</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">return</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #88C0D0\">type</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> SET_WIDTH</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #D8DEE9\">width</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #ECEFF4\">}</span></code></pre>\n\n<p>initialize はブロックエディタを開いたときに、保存してある値を使用して幅を設定する際に使用します。 </p>\n\n<h3 id=\"storereducerjs\"><em>store/reducer.js</em><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#storereducerjs\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>store の reducer を追加します。</p>\n\n<p><em>SET_WIDTH</em> では数値が渡された場合にのみ状態を変更し、幅の設定を行います。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">INITIALIZE</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">SET_WIDTH</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">./constant</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">export</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">default</span><span style=\"color: #D8DEE9FF\"> ( </span><span style=\"color: #D8DEE9\">state</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #88C0D0\">width</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">false</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #ECEFF4\">},</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">action</span><span style=\"color: #D8DEE9FF\"> ) </span><span style=\"color: #81A1C1\">=></span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">switch</span><span style=\"color: #D8DEE9FF\"> ( </span><span style=\"color: #D8DEE9\">action</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">type ) </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #81A1C1\">case</span><span style=\"color: #D8DEE9FF\"> INITIALIZE</span><span style=\"color: #ECEFF4\">:</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t</span><span style=\"color: #81A1C1\">if</span><span style=\"color: #D8DEE9FF\"> ( </span><span style=\"color: #D8DEE9\">state</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">width ) </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t\t</span><span style=\"color: #88C0D0\">setStyle</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #D8DEE9\">state</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">width )</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t</span><span style=\"color: #ECEFF4\">}</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t</span><span style=\"color: #81A1C1\">break;</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #81A1C1\">case</span><span style=\"color: #D8DEE9FF\"> SET_WIDTH</span><span style=\"color: #ECEFF4\">:</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t</span><span style=\"color: #81A1C1\">if</span><span style=\"color: #D8DEE9FF\"> (</span><span style=\"color: #A3BE8C\"> </span><span style=\"color: #ECEFF4\">/</span><span style=\"color: #81A1C1\">^</span><span style=\"color: #A3BE8C\">\\d</span><span style=\"color: #81A1C1\">+$</span><span style=\"color: #ECEFF4\">/</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">test</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #D8DEE9\">action</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">width ) ) </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t\t</span><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">newState</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">Object</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">assign</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">{},</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">state</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t\t</span><span style=\"color: #D8DEE9\">newState</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">width </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">action</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">width</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t\t</span><span style=\"color: #88C0D0\">setStyle</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #D8DEE9\">action</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">width )</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t\t</span><span style=\"color: #81A1C1\">return</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">newState</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t</span><span style=\"color: #ECEFF4\">}</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t</span><span style=\"color: #81A1C1\">break;</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">}</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">return</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">state</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #ECEFF4\">}</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">function</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">setStyle</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">width</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">remove</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> document</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">getElementById</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">set-editor-width</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">if</span><span style=\"color: #D8DEE9FF\"> ( </span><span style=\"color: #D8DEE9\">remove</span><span style=\"color: #D8DEE9FF\"> ) </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #D8DEE9\">remove</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">remove</span><span style=\"color: #D8DEE9FF\">()</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">}</span>\n\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">styleSheetElement</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> document</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">createElement</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">style</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #D8DEE9\">styleSheetElement</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">id </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">set-editor-width</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\tdocument</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9\">head</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">appendChild</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #D8DEE9\">styleSheetElement</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">sheet</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">styleSheetElement</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9\">sheet</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">styles</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">getStyles</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #D8DEE9\">width</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #8FBCBB\">Object</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">keys</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #D8DEE9\">styles</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">forEach</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #D8DEE9\">selector</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=></span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">style</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">styles</span><span style=\"color: #D8DEE9FF\">[ </span><span style=\"color: #D8DEE9\">selector</span><span style=\"color: #D8DEE9FF\"> ]</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #81A1C1\">if</span><span style=\"color: #D8DEE9FF\"> ( </span><span style=\"color: #D8DEE9\">sheet</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9\">insertRule</span><span style=\"color: #D8DEE9FF\"> ) </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t</span><span style=\"color: #D8DEE9\">sheet</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">insertRule</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">`</span><span style=\"color: #A3BE8C\">#editor </span><span style=\"color: #5E81AC\">${</span><span style=\"color: #A3BE8C\"> </span><span style=\"color: #D8DEE9\">selector</span><span style=\"color: #A3BE8C\"> </span><span style=\"color: #5E81AC\">}</span><span style=\"color: #ECEFF4\">`</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">{</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">style</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">}</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">sheet</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9\">cssRules</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">length )</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">else</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t</span><span style=\"color: #D8DEE9\">sheet</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">addRule</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">`</span><span style=\"color: #A3BE8C\">#editor </span><span style=\"color: #5E81AC\">${</span><span style=\"color: #A3BE8C\"> </span><span style=\"color: #D8DEE9\">selector</span><span style=\"color: #A3BE8C\"> </span><span style=\"color: #5E81AC\">}</span><span style=\"color: #ECEFF4\">`</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">style</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #ECEFF4\">}</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #ECEFF4\">}</span>\n\n<span style=\"color: #81A1C1\">function</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">getStyles</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">width</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">return</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">.editor-writing-flow</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">`</span><span style=\"color: #A3BE8C\">max-width: </span><span style=\"color: #5E81AC\">${</span><span style=\"color: #A3BE8C\"> </span><span style=\"color: #D8DEE9\">width</span><span style=\"color: #A3BE8C\"> </span><span style=\"color: #5E81AC\">}</span><span style=\"color: #A3BE8C\">px; width: auto; margin: auto</span><span style=\"color: #ECEFF4\">`</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">.wp-block</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">max-width: 100%; margin: 0 auto; padding: 0;</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #ECEFF4\">}</span></code></pre>\n\n<h3 id=\"storeselectorsjs\"><em>store/selectors.js</em><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#storeselectorsjs\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>store の selectors を追加します。</p>\n\n<p><em>getWidth</em> は現在の <em>width</em> の状態を返します。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #81A1C1\">export</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">function</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">getWidth</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">state</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">return</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">state</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">width </span><span style=\"color: #81A1C1\">&#x26;&#x26;</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">state</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">width </span><span style=\"color: #81A1C1\">></span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #B48EAD\">0</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">?</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">state</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">width </span><span style=\"color: #81A1C1\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">''</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #ECEFF4\">}</span></code></pre>\n\n<h3 id=\"storeindexjs\"><em>store/index.js</em><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#storeindexjs\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>ここまでで追加した actions、reducer、selectors を使用して store を登録します。</p>\n\n<p>そしてここが今回の肝となる部分です。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">registerStore</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">data</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">reducer</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">./reducer</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">*</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">as</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">selectors</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">./selectors</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">*</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">as</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">actions</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">./actions</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">STORE_NAME</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">./constant</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #88C0D0\">registerStore</span><span style=\"color: #D8DEE9FF\">( STORE_NAME</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">reducer</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">selectors</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">actions</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">persist</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> [ </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">width</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> ] </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span></code></pre>\n\n<p><span class=\"double-underline\">保持したい値を </span><em><span class=\"double-underline\">persist</span></em><span class=\"double-underline\"> で指定</span>します。</p>\n\n<p>これによってブラウザのローカルストレージに値が保存され、リロード等を行っても値が保持されるようになります。</p>\n\n<figure class=\"wp-block-image\"><img src=\"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2019/05/201905231655.png\" alt=\"\" class=\"wp-image-1756\"></figure>\n\n<h3 id=\"componentsset-editor-widthjs\"><em>components/set-editor-width.js</em><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#componentsset-editor-widthjs\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>値の入力方法を提供するためのコンポーネントを作成します。</p>\n\n<p>今回は簡単にするため <em>prompt</em> で入力するようにしています。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">Fragment</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9\">element</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">PluginMoreMenuItem</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9\">editPost</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">withSelect</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">withDispatch</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">data</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">compose</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9\">compose</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">STORE_NAME</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">../store/constant</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">function</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">SetEditorWidth</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">setWidth</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">return</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">&#x3C;Fragment></span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #81A1C1\">&#x3C;PluginMoreMenuItem</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t</span><span style=\"color: #8FBCBB\">onClick</span><span style=\"color: #81A1C1\">={</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">setWidth</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">}</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #81A1C1\">></span>\n<span style=\"color: #D8DEE9FF\">\t\t\tエディタ幅設定</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #81A1C1\">&#x3C;/PluginMoreMenuItem></span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #81A1C1\">&#x3C;/Fragment>;</span>\n<span style=\"color: #ECEFF4\">}</span>\n\n<span style=\"color: #81A1C1\">export</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">default</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">compose</span><span style=\"color: #D8DEE9FF\">(</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #88C0D0\">withSelect</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #D8DEE9\">select</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=></span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #81A1C1\">return</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t</span><span style=\"color: #88C0D0\">width</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">select</span><span style=\"color: #D8DEE9FF\">( STORE_NAME )</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">getWidth</span><span style=\"color: #D8DEE9FF\">()</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #88C0D0\">withDispatch</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">dispatch</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">width</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=></span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #81A1C1\">return</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t\t\t</span><span style=\"color: #88C0D0\">setWidth</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">()</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=></span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">dispatch</span><span style=\"color: #D8DEE9FF\">( STORE_NAME )</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">setWidth</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #88C0D0\">prompt</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">設定したい幅を入力(px)</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">width</span><span style=\"color: #D8DEE9FF\"> ) )</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">\t\t</span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #D8DEE9FF\">)( </span><span style=\"color: #D8DEE9\">SetEditorWidth</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span></code></pre>\n\n<h3 id=\"componentsindexjs\"><em>components/index.js</em><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#componentsindexjs\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">SetEditorWidth</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">./set-editor-width</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">export</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">SetEditorWidth</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #81A1C1\">;</span></code></pre>\n\n<h3 id=\"indexjs\"><em>index.js</em><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#indexjs\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>ここまでで追加した要素を使用してプラグインの登録と初期の動作を設定します。</p>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">registerPlugin</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">plugins</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">dispatch</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #D8DEE9FF\">data</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">./store</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">STORE_NAME</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">./store/constant</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">SetEditorWidth</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">./components</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #88C0D0\">registerPlugin</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">my-test-plugin</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #88C0D0\">render</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">()</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=></span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">&#x3C;SetEditorWidth/></span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #D8DEE9\">wp</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">domReady</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #81A1C1\">function</span><span style=\"color: #ECEFF4\">()</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #88C0D0\">dispatch</span><span style=\"color: #D8DEE9FF\">( STORE_NAME )</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">initialize</span><span style=\"color: #D8DEE9FF\">()</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span></code></pre>\n\n<h2 id=\"動作確認\">動作確認<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#動作確認\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<figure class=\"wp-block-image\"><a href=\"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2019/05/201905232131.gif\"><img src=\"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2019/05/201905232131.gif\" alt=\"\" class=\"wp-image-1759\"></a></figure>\n\n<p>リロード後も幅が保持されることが確認できました。</p>\n<!-- /wp:paragraph --></body></html>","excerpt":"Gutenbergには store による状態管理を簡単に行う方法が用意されています。 さらにその状態をブラウザのローカルストレージに保持するための仕組みもあります。 設定を保存することで、より便利なプラグインを作成することが可能です。  ...","postType":"post","tags":[{"slug":"gutenberg","name":"Gutenberg"},{"slug":"registerstore","name":"registerStore"}],"thumbnail":"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/12/banner-772x250.jpg","dominantColor":"rgba(111,111,111,1)","createdAt":"2019-05-23T12:48:12.000Z","updatedAt":null},"prev":{"id":"wpxml-change-block-keywords","title":"Gutenbergのブロック検索のキーワードを自由に設定できるようにしてみる","excerpt":"機能 ブロック検索に使用するキーワードをサイドバーから設定できるようにします。  いくつかのサイトでも言及されていますが、ブロックの検索キーワードが日本語になっているものがあります。      スラッシュの後に日本語を入力するのはとても面倒...","postType":"post","thumbnail":"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/12/banner-772x250.jpg","createdAt":"2019-05-24T08:21:50.000Z","updatedAt":null},"next":{"id":"wpxml-gutenberg-register-store-data","title":"GutenbergのregisterStoreで注意すべき点","excerpt":"より高度なGutenbergプラグインを作成する場合は registerStore を使用した状態管理が必須です。 実装方法によっては状態を変更してもすぐに画面に反映されないため注意が必要です。   例　  例えば flag の状態が fa...","postType":"post","thumbnail":"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/12/banner-772x250.jpg","createdAt":"2019-05-22T05:04:34.000Z","updatedAt":null},"headerPages":[],"footerPages":[{"label":"About","url":"/pages/wpxml-about/"},{"label":"プライバシーポリシー","url":"/pages/wpxml-privacy-policy/"},{"label":"お問い合わせ","url":"/pages/wpxml-contact/"}]},"__N_SSG":true}