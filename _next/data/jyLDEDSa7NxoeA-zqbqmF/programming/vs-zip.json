{"pageProps":{"post":{"id":"wpxml-programming-vs-zip","title":"【Visual Studio 2017 C#】ZIPにまとめる動作の自動化","content":"<html><head></head><body><div class=\"toc-wrapper\"><input type=\"checkbox\" class=\"toc-checkbox\" id=\"toc-checkbox-aqor35k1m0\" checked><label class=\"toc-title\" for=\"toc-checkbox-aqor35k1m0\">目次</label><nav class=\"toc\"><ol class=\"toc-level toc-level-1\"><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#目次\">目次</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#7zipの準備\">7zipの準備</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#必要なファイルをコピーするコマンドを設定\">必要なファイルをコピーするコマンドを設定</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#zipにまとめるコマンドを追記\">ZIPにまとめるコマンドを追記</a></li></ol></nav></div><div class=\"memo-box\">ZIPにまとめる動作の自動化の設定に関するメモ<br /><a href=\"/programming/vs-installer-merge\" rel=\"noreferrer noopener\" target=\"_blank\">setup.msiとsetup.exeのマージの自動化</a> の続き</div><br /><div>ここではVisual Studioで生成された成果物などをZIPにまとめる動作を自動化する手順を残しています。</div><br /><div>Visual Studioを使用してインストーラ作成を自動化する手順は<a href=\"/programming/vs-installer-merge\" target=\"_blank\" rel=\"noreferrer noopener\">前の投稿</a>を参照してください。</div><br /><h2 id=\"目次\">目次<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#目次\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2><br />１．<a href=\"/programming/vs-trial-product-solution\" target=\"_blank\" rel=\"noreferrer noopener\">製品版と試用版をビルド構成で切り替えできるように設定</a><br /><br />２．<a href=\"/programming/vs-confuserex\" target=\"_blank\" rel=\"noreferrer noopener\">難読化の自動化</a><br /><br />３．<a href=\"/programming/vs-installer\" target=\"_blank\" rel=\"noreferrer noopener\">インストーラ作成の自動化</a><br /><br />４．<a href=\"/programming/vs-installer-merge\" target=\"_blank\" rel=\"noreferrer noopener\">setup.exe と Setup.msi のマージの自動化</a><br /><br />５．<a href=\"/programming/vs-zip\" target=\"_blank\" rel=\"noreferrer noopener\">ZIPにまとめる動作の自動化</a>　&#x3C;-今ここ<br /><h2 id=\"7zipの準備\">7zipの準備<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#7zipの準備\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2><br />１．コマンドラインバージョンの7zipをダウンロード<br /><div><a href=\"https://sevenzip.osdn.jp/download.html\" target=\"_blank\" rel=\"noreferrer noopener\">https://sevenzip.osdn.jp/download.html</a></div><br /><div>２．わかりやすいところに展開（以下は「C:\\7zip」）</div><br /><h2 id=\"必要なファイルをコピーするコマンドを設定\">必要なファイルをコピーするコマンドを設定<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#必要なファイルをコピーするコマンドを設定\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2><br />１．PostBuildEventを開く<br /><br /><a href=\"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/06/201806190341.png\"><img class=\"alignnone size-medium wp-image-125\" src=\"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/06/201806190341-300x214.png\" alt=\"\" width=\"300\" height=\"214\"></a><br /><br /><a href=\"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/06/201806190342.png\"><img class=\"alignnone size-medium wp-image-126\" src=\"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/06/201806190342-300x240.png\" alt=\"\" width=\"300\" height=\"240\"></a><br /><br />２．コマンドを追記<br /><br />例：<br /><pre>copy /Y \"$(ProjectDir)..\\license.txt\" D:\\workspace\\Sample1\\Distribution\\製品版\\license.txt</pre><br /><pre>copy /Y \"$(ProjectDir)..\\license_trial.txt\" D:\\workspace\\Sample1\\Distribution\\試用版\\license.txt</pre><br /><h2 id=\"zipにまとめるコマンドを追記\">ZIPにまとめるコマンドを追記<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#zipにまとめるコマンドを追記\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2><br />例：<br /><pre>C:\\7zip\\7za.exe a D:\\workspace\\Sample1\\Distribution\\製品版.zip D:\\workspace\\Sample1\\Distribution\\製品版</pre><br /><pre>C:\\7zip\\7za.exe a D:\\workspace\\Sample1\\Distribution\\試用版.zip D:\\workspace\\Sample1\\Distribution\\試用版</pre><br /><br /><a href=\"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/06/201806191323.png\"><img class=\"alignnone size-medium wp-image-146\" src=\"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/06/201806191323-190x300.png\" alt=\"\" width=\"190\" height=\"300\"></a><br /><br /><a href=\"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/06/201806191327.png\"><img class=\"alignnone size-full wp-image-147\" src=\"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/06/201806191327.png\" alt=\"\" width=\"272\" height=\"247\"></a><br /><br />使用したソース一式<br /><br /><div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Fgithub.com%2Ftechnote-space%2FTrial_Installer_ZIP_example?id=blog-card-gn7qh9vans&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-programming-vs-zip%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-gn7qh9vans\"></iframe></div></body></html>","excerpt":"ZIPにまとめる動作の自動化の設定に関するメモ setup.msiとsetup.exeのマージの自動化 の続き ここではVisual Studioで生成された成果物などをZIPにまとめる動作を自動化する手順を残しています。 Visual S...","postType":"post","tags":[{"slug":"c","name":"C#"},{"slug":"%e3%83%97%e3%83%ad%e3%82%b0%e3%83%a9%e3%83%9f%e3%83%b3%e3%82%b0","name":"プログラミング"}],"thumbnail":"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/06/C.png","dominantColor":"rgba(144,89,154,1)","createdAt":"2018-06-19T04:28:39.000Z","updatedAt":null},"prev":{"id":"wpxml-programming-vs-confuserex-propertygrid","title":"【Visual Studio 2017 C#】ConfuserExで難読化するとPropertyGridコントロールの表示名が空になる","excerpt":"ConfuserExで難読化を行ったときに起きた現象に関するメモ PropertyGridコントロールはオブジェクトを渡すだけでそのメンバーの値をいじることができるようになる便利なコントロールです。 通常はプロパティ名がそのまま表示されるの...","postType":"post","thumbnail":"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/06/C.png","createdAt":"2018-06-19T09:20:55.000Z","updatedAt":null},"next":{"id":"wpxml-programming-vs-installer-merge","title":"【Visual Studio 2017 C#】setup.msiとsetup.exeのマージの自動化","excerpt":"インストーラ作成で出力されるmsiとexeのマージの自動化の設定に関するメモ インストーラ作成の自動化 の続き ここではVisual Studioで作成されたインストーラである「msi」と「exe」ファイルをマージする動作を自動化させるまで...","postType":"post","thumbnail":"https://raw.githubusercontent.com/technote-space/my-blog-assets/main/uploads/2018/06/C.png","createdAt":"2018-06-18T19:10:20.000Z","updatedAt":null},"headerPages":[],"footerPages":[{"label":"About","url":"/pages/wpxml-about/"},{"label":"プライバシーポリシー","url":"/pages/wpxml-privacy-policy/"},{"label":"お問い合わせ","url":"/pages/wpxml-contact/"}]},"__N_SSG":true}