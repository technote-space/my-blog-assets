{"pageProps":{"post":{"id":"wpxml-gutenberg-packages","title":"Gutenbergのパッケージのバージョン取得ライブラリ","content":"<html><head></head><body><div class=\"toc-wrapper\"><input type=\"checkbox\" class=\"toc-checkbox\" id=\"toc-checkbox-eqfk6aspvn\" checked><label class=\"toc-title\" for=\"toc-checkbox-eqfk6aspvn\">目次</label><nav class=\"toc\"><ol class=\"toc-level toc-level-1\"><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#処理\">処理</a><ol class=\"toc-level toc-level-2\"><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#ライブラリ内\">ライブラリ内</a></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#api\">API</a></li><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#リポジトリ\">リポジトリ</a></li></ol></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#キャッシュ\">キャッシュ</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#インストール\">インストール</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#使用方法\">使用方法</a></li></ol></nav></div><div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Ftechnote.space%2Fwordpress%2Fgutenberg-package-versions?id=blog-card-uib2p0k5gh&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-gutenberg-packages%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-uib2p0k5gh\"></iframe></div>\n\n<p>こちらの記事で紹介したAPIをより簡単に利用するためのライブラリです。</p>\n\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Fgithub.com%2Ftechnote-space%2Fgutenberg-packages?id=blog-card-e23oill8jl&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-gutenberg-packages%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-e23oill8jl\"></iframe></div>\n\n<h2 id=\"処理\">処理<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#処理\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<p>以下の順でデータの取得を試みます。</p>\n\n<ol><li>ライブラリ内</li><li>API</li><li>リポジトリ</li></ol>\n\n<h3 id=\"ライブラリ内\">ライブラリ内<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#ライブラリ内\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>API更新用のリポジトリを require しています。</p>\n\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Fgithub.com%2Ftechnote-space%2Fgutenberg-package-versions?id=blog-card-r8pt3qdof1&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-gutenberg-packages%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-r8pt3qdof1\"></iframe></div>\n\n<p>このリポジトリ自体にもデータを置いてあるのでそれを使用します。</p>\n\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Fgithub.com%2Ftechnote-space%2Fgutenberg-package-versions%2Ftree%2Fmaster%2Fdata?id=blog-card-35kmjj2469&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-gutenberg-packages%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-35kmjj2469\"></iframe></div>\n\n<p>外部へのリクエストを行わないので処理は速いです。</p>\n\n<h3 id=\"api\">API<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#api\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>ライブラリ内のデータはダウンロードした時点のものなので、最新のものはありません。</p>\n\n<p>その場合は毎日更新しているAPIに問い合わせます。</p>\n\n<h3 id=\"リポジトリ\">リポジトリ<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#リポジトリ\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<p>デイリー更新のAPIでも情報がない場合は直接リポジトリから取得します。</p>\n\n<p>ただしパッチバージョンは考慮されません。</p>\n\n<h2 id=\"キャッシュ\">キャッシュ<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#キャッシュ\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<p>結果は1日キャッシュされます。</p>\n\n<p>ただし、WordPressのバージョンやGutenbergプラグインの使用状態、Gutenbergプラグインのバージョンが変更された場合はキャッシュはクリアされます。</p>\n\n<h2 id=\"インストール\">インストール<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#インストール\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<pre class=\"language-bash\" style=\"background: #2e3440\"><code class=\"language-bash\"><span style=\"color: #D8DEE9FF\">composer require technote/gutenberg-packages</span></code></pre>\n\n<h2 id=\"使用方法\">使用方法<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#使用方法\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<pre class=\"language-php\" style=\"background: #2e3440\"><code class=\"language-php\"><span style=\"color: #ECEFF4\">&#x3C;?php</span>\n<span style=\"color: #81A1C1\">use</span><span style=\"color: #D8DEE9FF\"> Technote</span><span style=\"color: #ECEFF4\">\\</span><span style=\"color: #D8DEE9FF\">GutenbergPackages</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">packages</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">new</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">GutenbergPackages</span><span style=\"color: #D8DEE9FF\">()</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #4C566A\">// ブロックエディタかどうか</span>\n<span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">packages</span><span style=\"color: #81A1C1\">-></span><span style=\"color: #88C0D0\">is_block_editor</span><span style=\"color: #D8DEE9FF\">()</span><span style=\"color: #81A1C1\">;</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #4C566A\">// true or false</span>\n\n<span style=\"color: #4C566A\">// Gutenbergプラグインのバージョン</span>\n<span style=\"color: #4C566A\">// プラグインが無効の時は空</span>\n<span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">packages</span><span style=\"color: #81A1C1\">-></span><span style=\"color: #88C0D0\">get_gutenberg_version</span><span style=\"color: #D8DEE9FF\">()</span><span style=\"color: #81A1C1\">;</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #4C566A\">// e.g. 6.0.0</span>\n\n<span style=\"color: #4C566A\">// パッケージのバージョン取得</span>\n<span style=\"color: #4C566A\">// ブロックエディタが無効の時は false</span>\n<span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">packages</span><span style=\"color: #81A1C1\">-></span><span style=\"color: #88C0D0\">get_editor_package_versions</span><span style=\"color: #D8DEE9FF\">()</span><span style=\"color: #81A1C1\">;</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #4C566A\">// array of (package => version)</span>\n<span style=\"color: #4C566A\">/** e.g.</span>\n<span style=\"color: #4C566A\">[</span>\n<span style=\"color: #4C566A\">  \"wp-a11y\"        => \"2.0.2\",</span>\n<span style=\"color: #4C566A\">  \"wp-annotations\" => \"1.0.8\",</span>\n<span style=\"color: #4C566A\">  \"wp-api-fetch\"   => \"2.2.8\",</span>\n\n<span style=\"color: #4C566A\">  ...</span>\n\n<span style=\"color: #4C566A\">  \"wp-url\"         => \"2.3.3\",</span>\n<span style=\"color: #4C566A\">  \"wp-viewport\"    => \"2.1.1\",</span>\n<span style=\"color: #4C566A\">  \"wp-wordcount\"   => \"2.0.3\"</span>\n<span style=\"color: #4C566A\">]</span>\n<span style=\"color: #4C566A\">*/</span>\n\n<span style=\"color: #4C566A\">// パッケージのバージョン個別取得</span>\n<span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">packages</span><span style=\"color: #81A1C1\">-></span><span style=\"color: #88C0D0\">get_editor_package_version</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">wp-editor</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #4C566A\">// e.g. 9.0.11</span>\n<span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">packages</span><span style=\"color: #81A1C1\">-></span><span style=\"color: #88C0D0\">get_editor_package_version</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">editor</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #4C566A\">// same as above</span>\n\n<span style=\"color: #4C566A\">// パッケージが有効かどうか</span>\n<span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">packages</span><span style=\"color: #81A1C1\">-></span><span style=\"color: #88C0D0\">is_support_editor_package</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">wp-editor</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #4C566A\">// true or false</span>\n<span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">packages</span><span style=\"color: #81A1C1\">-></span><span style=\"color: #88C0D0\">is_support_editor_package</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">editor</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #4C566A\">// same as above</span>\n\n<span style=\"color: #4C566A\">// パッケージをフィルタ</span>\n<span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">packages</span><span style=\"color: #81A1C1\">-></span><span style=\"color: #88C0D0\">filter_packages</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">[</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">editor</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">wp-editor</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">test-package</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">components</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">wp-data</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">wp-data</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #ECEFF4\">]</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #4C566A\">/** e.g.</span>\n<span style=\"color: #4C566A\">[</span>\n<span style=\"color: #4C566A\">\t'wp-editor',</span>\n<span style=\"color: #4C566A\">\t'wp-components',</span>\n<span style=\"color: #4C566A\">\t'wp-data',</span>\n<span style=\"color: #4C566A\">]</span>\n<span style=\"color: #4C566A\">*/</span>\n\n<span style=\"color: #4C566A\">// パッケージをフィルタしてバージョンを付与</span>\n<span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">packages</span><span style=\"color: #81A1C1\">-></span><span style=\"color: #88C0D0\">fill_package_versions</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">[</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">editor</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">wp-editor</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">test-package</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">components</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">wp-data</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">wp-data</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #ECEFF4\">]</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #4C566A\">/** e.g.</span>\n<span style=\"color: #4C566A\">[</span>\n<span style=\"color: #4C566A\">\t'wp-editor'     => '9.0.11',</span>\n<span style=\"color: #4C566A\">\t'wp-components' => '7.0.8',</span>\n<span style=\"color: #4C566A\">\t'wp-data'       => '4.2.1',</span>\n<span style=\"color: #4C566A\">]</span>\n<span style=\"color: #4C566A\">*/</span></code></pre>\n\n<p>パッケージをフィルタすることで wp_enqueue_script の $deps に無効なパッケージが渡りません。</p>\n\n<pre class=\"language-php\" style=\"background: #2e3440\"><code class=\"language-php\"><span style=\"color: #ECEFF4\">&#x3C;?php</span>\n<span style=\"color: #81A1C1\">use</span><span style=\"color: #D8DEE9FF\"> Technote</span><span style=\"color: #ECEFF4\">\\</span><span style=\"color: #D8DEE9FF\">GutenbergPackages</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">packages</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">new</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">GutenbergPackages</span><span style=\"color: #D8DEE9FF\">()</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #88C0D0\">wp_enqueue_script</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">test-script</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">, </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">path/to/javascript/index.js</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">, </span><span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">packages</span><span style=\"color: #81A1C1\">-></span><span style=\"color: #88C0D0\">filter_packages</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">[</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">wp-block-editor</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">wp-components</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">wp-compose</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">wp-element</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">wp-editor</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #ECEFF4\">]</span><span style=\"color: #D8DEE9FF\">, </span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">lodash</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">]</span><span style=\"color: #D8DEE9FF\"> ) )</span><span style=\"color: #81A1C1\">;</span></code></pre>\n\n<p>fill_package_versions で取得した値を wp_localize_script に渡すことで、JavaScript側でバージョン情報を使用することができます。</p>\n\n<pre class=\"language-php\" style=\"background: #2e3440\"><code class=\"language-php\"><span style=\"color: #ECEFF4\">&#x3C;?php</span>\n<span style=\"color: #81A1C1\">use</span><span style=\"color: #D8DEE9FF\"> Technote</span><span style=\"color: #ECEFF4\">\\</span><span style=\"color: #D8DEE9FF\">GutenbergPackages</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">packages</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">new</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #8FBCBB\">GutenbergPackages</span><span style=\"color: #D8DEE9FF\">()</span><span style=\"color: #81A1C1\">;</span>\n\n<span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">depends</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">[</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">wp-block-editor</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">wp-components</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">wp-compose</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">wp-data</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">wp-element</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #D8DEE9FF\">\t</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">wp-editor</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">,</span>\n<span style=\"color: #ECEFF4\">]</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #88C0D0\">wp_enqueue_script</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">test-script</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">, </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">path/to/javascript/index.js</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">, </span><span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">packages</span><span style=\"color: #81A1C1\">-></span><span style=\"color: #88C0D0\">filter_packages</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">depends</span><span style=\"color: #D8DEE9FF\">, </span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">lodash</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">]</span><span style=\"color: #D8DEE9FF\"> ) )</span><span style=\"color: #81A1C1\">;</span>\n<span style=\"color: #88C0D0\">wp_localize_script</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">test-script</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">, </span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">PackageVersions</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #D8DEE9FF\">, </span><span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">packages</span><span style=\"color: #81A1C1\">-></span><span style=\"color: #88C0D0\">fill_package_versions</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #81A1C1\">$</span><span style=\"color: #D8DEE9\">depends</span><span style=\"color: #D8DEE9FF\">) )</span><span style=\"color: #81A1C1\">;</span></code></pre>\n\n<pre class=\"language-js\" style=\"background: #2e3440\"><code class=\"language-js\"><span style=\"color: #4C566A\">// JavaScript</span>\n<span style=\"color: #8FBCBB\">console</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">log</span><span style=\"color: #D8DEE9FF\">( </span><span style=\"color: #D8DEE9\">PackageVersions</span><span style=\"color: #D8DEE9FF\"> )</span><span style=\"color: #81A1C1\">;</span></code></pre>\n<!-- /wp:code --></body></html>","excerpt":"こちらの記事で紹介したAPIをより簡単に利用するためのライブラリです。 処理  以下の順でデータの取得を試みます。   1. ライブラリ内  2. API  3. リポジトリ   ライブラリ内  API更新用のリポジトリを require ...","postType":"post","tags":[{"slug":"gutenberg","name":"Gutenberg"}],"thumbnail":"https://technote.space/uploads/2018/12/banner-772x250.jpg","dominantColor":"rgba(111,111,111,1)","createdAt":"2019-07-18T16:52:31.000Z","updatedAt":null},"prev":{"id":"wpxml-js-array-to-object","title":"JavaScript でオブジェクトの配列の特定のキーの値を使用してオブジェクトに変換する","excerpt":"やりたいこと のようなオブジェクトの配列を、idの値をキーとする以下のようなオブジェクトに変換。 このように変換しておくことで  で id = 2 のデータがあるかどうかがすぐわかり、また  で id = 2 のデータを簡単に取得可能。  ...","postType":"post","tags":[{"slug":"%e3%83%a1%e3%83%a2","name":"メモ"}],"thumbnail":"https://technote.space/uploads/2019/08/javascript.png","createdAt":"2019-08-05T04:51:49.000Z","updatedAt":null},"next":{"id":"wpxml-gutenberg-package-versions","title":"Gutenbergのパッケージのバージョン取得API","excerpt":"Gutenbergは下位互換性はあまり考慮されておらず、破壊的な変更が度々発生します。 また、それぞれの環境で使用されているGutenbergや使用されているパッケージのバージョンを取得する方法がありません。 下記の記事で書いてあるように一...","postType":"post","tags":[{"slug":"api","name":"api"},{"slug":"gutenberg","name":"Gutenberg"},{"slug":"travis-ci","name":"Travis CI"}],"thumbnail":"https://technote.space/uploads/2018/12/banner-772x250.jpg","createdAt":"2019-07-18T16:51:41.000Z","updatedAt":null},"headerPages":[],"footerPages":[{"label":"About","url":"/pages/wpxml-about/"},{"label":"プライバシーポリシー","url":"/pages/wpxml-privacy-policy/"},{"label":"お問い合わせ","url":"/pages/wpxml-contact/"}]},"__N_SSG":true}