{"pageProps":{"post":{"id":"wpxml-gutenberg-show-word-count","title":"【Gutenberg】ブロックエディタに文字数カウントを常時表示する","content":"<html><head></head><body><div class=\"toc-wrapper\"><input type=\"checkbox\" class=\"toc-checkbox\" id=\"toc-checkbox-or3cbb0ko8\" checked><label class=\"toc-title\" for=\"toc-checkbox-or3cbb0ko8\">目次</label><nav class=\"toc\"><ol class=\"toc-level toc-level-1\"><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#文字数カウントコンポーネント作成\">文字数カウントコンポーネント作成</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#コンポーネントを-render\">コンポーネントを render</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#読み込み\">読み込み</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#動作\">動作</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#プラグイン化\">プラグイン化</a><ol class=\"toc-level toc-level-2\"><li class=\"toc-item toc-item-h3\"><a class=\"toc-link toc-link-h3\" href=\"#導入手順\">導入手順</a></li></ol></li></ol></nav></div><p>ブロックエディタに任意の要素を追加する方法を使用することで、文字数カウントを常時表示させておくことが可能です。</p>\n\n<figure class=\"wp-block-embed-wordpress wp-block-embed is-type-wp-embed is-provider-technote\"><div class=\"wp-block-embed__wrapper\">\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Ftechnote.space%2Fwordpress%2Fadd-component-to-blockeditor?id=blog-card-fn2gnul02t&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-gutenberg-show-word-count%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-fn2gnul02t\"></iframe></div>\n</div></figure>\n\n<h2 id=\"文字数カウントコンポーネント作成\">文字数カウントコンポーネント作成<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#文字数カウントコンポーネント作成\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<p>Word Count パッケージを使用して文字数カウント用のコンポーネントを作成します。</p>\n\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Fgithub.com%2FWordPress%2Fgutenberg%2Ftree%2Fmaster%2Fpackages%2Fwordcount?id=blog-card-kg76q0k732&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-gutenberg-show-word-count%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-kg76q0k732\"></iframe></div>\n\n<p><em>count</em> 関数は第一引数にカウント対象の文字列、第二引数にカウントタイプを指定します。</p>\n\n<p>カウントタイプは３種類あります。</p>\n\n<ul><li>words (単語数(英語など単語の前後に空白があるような言語用))</li><li>characters_excluding_spaces (スペースを除いた文字数)</li><li>characters_including_spaces (スペースを含んだ文字数)</li></ul>\n\n<p>日本語でデフォルトで使用されているのは <em><span class=\"double-underline\">characters_including_spaces</span></em> です。</p>\n\n<figure class=\"wp-block-image\"><a href=\"https://technote.space/uploads/2019/09/201909091207.png\"><img src=\"https://technote.space/uploads/2019/09/201909091207.png\" alt=\"\" class=\"wp-image-2123\"></a></figure>\n\n<p>getEditedPostAttribute( 'content' ) で編集中の本文を取得し、カウントタイプ characters_including_spaces で文字数をカウントするコンポーネントを作成します。</p>\n\n<p><em>components/word-count.js</em></p>\n\n<pre class=\"wp-block-code\" style=\"background: #2e3440\"><code style=\"color: undefined\">const { withSelect } = wp.data;\nconst { compose } = wp.compose;\nconst { count } = wp.wordcount;\nconst { sprintf } = wp.i18n;\n\nconst getWordCount = ( content ) => count( content, 'characters_including_spaces' );\n\nconst WordCount = ( { content} ) => &#x3C;span>{ sprintf( translate( '%d characters' ), getWordCount( content ) ) } &#x3C;/span>;\n\nexport default compose(\n\twithSelect( select => ( {\n\t\tcontent: select( 'core/editor' ).getEditedPostAttribute( 'content' )\n\t} ) ),\n)( WordCount );</code></pre>\n\n<h2 id=\"コンポーネントを-render\">コンポーネントを render<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#コンポーネントを-render\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<p>作成した文字数カウントコンポーネントをブロックエディタに表示させます。</p>\n\n<p>ヘッダーあたりが見やすいと思うので、 <em>.edit-post-header-toolbar</em> に挿入させます。</p>\n\n<p><em>index.js</em></p>\n\n<pre class=\"wp-block-code\" style=\"background: #2e3440\"><code style=\"color: undefined\">const { render } = wp.element;\nimport { WordCount } from './components';\n\nwp.domReady( function() {\n\tdocument.querySelector( '.edit-post-header-toolbar' ).insertAdjacentHTML( 'beforeend', '&#x3C;div class=\"character-count\">&#x3C;/div>' );\n\trender(\n\t\t&#x3C;WordCount/>,\n\t\tdocument.querySelector( '.character-count' ),\n\t);\n} );</code></pre>\n\n<h2 id=\"読み込み\">読み込み<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#読み込み\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<p>後はコンパイルして <em>wp_enqueue_script</em> で依存関係を指定しながら読みこめば完成です。</p>\n\n<h2 id=\"動作\">動作<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#動作\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<figure class=\"wp-block-image\"><a href=\"https://technote.space/uploads/2019/09/201909091225.gif\"><img src=\"https://technote.space/uploads/2019/09/201909091225.gif\" alt=\"\" class=\"wp-image-2124\"></a></figure>\n\n<h2 id=\"プラグイン化\">プラグイン化<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#プラグイン化\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h2>\n\n<div class=\"blog-card\"><iframe src=\"https://blog-card-ten.vercel.app/card/https%3A%2F%2Fgithub.com%2Ftechnote-space%2Fadvanced-block-editor?id=blog-card-9aock9qqlb&#x26;referrer=https%3A%2F%2Ftechnote.space%2Fposts%2Fwpxml-gutenberg-show-word-count%2F\" frameborder=\"0\" scrolling=\"no\" loading=\"lazy\" data-id=\"blog-card-9aock9qqlb\"></iframe></div>\n\n<h3 id=\"導入手順\">導入手順<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#導入手順\"><svg class=\"icon icon-link\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" aria-labelledby=\"paperclipIconTitle\" stroke=\"#2329EE\" stroke-width=\"1\" stroke-linecap=\"square\" stroke-linejoin=\"miter\" fill=\"none\" color=\"#131996\"><path d=\"M7.93517339,13.7795989 L15.1617306,6.55304173 C16.03921,5.67631227 17.4656766,5.67631227 18.343156,6.55304173 C19.2206355,7.43052116 19.2206355,8.85773771 18.343156,9.73521714 L8.40091248,19.5477137 C6.93619681,21.0124294 4.56325242,21.0124294 3.09853675,19.5477137 C1.63382108,18.083748 1.63382108,15.7093037 3.09853675,14.245338 L12.9335328,4.53783896 C14.9839848,2.48738701 18.3094068,2.48738701 20.3568588,4.53783896 C22.4088107,6.58904088 22.4088107,9.91146301 20.3583588,11.961915 L13.2390491,19.0819746\"></path></svg></a></h3>\n\n<ol><li>最新版をGitHubからダウンロード<br> <a href=\"https://github.com/technote-space/advanced-block-editor/releases/latest/download/release.zip\" target=\"_blank\" rel=\"noreferrer noopener\">release.zip</a> </li><li>「プラグインのアップロード」からインストール<br><figure><img class=\"wp-image-1428\" style=\"width: 600px;\" src=\"https://technote.space/uploads/2019/01/04102143.png\" alt=\"\"></figure></li><li>プラグインを有効化</li></ol>\n<!-- /wp:list --></body></html>","excerpt":"ブロックエディタに任意の要素を追加する方法を使用することで、文字数カウントを常時表示させておくことが可能です。 文字数カウントコンポーネント作成  Word Count パッケージを使用して文字数カウント用のコンポーネントを作成します。  ...","postType":"post","tags":[{"slug":"gutenberg","name":"Gutenberg"}],"thumbnail":"https://technote.space/uploads/2018/12/banner-772x250.jpg","dominantColor":"rgba(111,111,111,1)","createdAt":"2019-09-11T14:58:37.000Z","updatedAt":null},"prev":{"id":"wpxml-release-github-actions","title":"GitHub Actions のリリース手順を自動化する GitHub Actions","excerpt":"GitHub Actions の種類にはDockerコンテナ版とJavaScript版があります。 元々はDocker版しかなかったようですが、JavaScript版は起動がとても早く、これからはJavaScript版が主流になっていくと思...","postType":"post","thumbnail":"https://technote.space/uploads/2019/08/github-actions.png","createdAt":"2019-09-16T08:55:54.000Z","updatedAt":null},"next":{"id":"wpxml-use-github-actions","title":"GitHub Actions で作業を効率化","excerpt":"最近CI/CDサービスが標準サポートされると発表されたGitHub Actionsですが、いろいろ試してわかった注意点などをまとめておきます。 色々試したリポジトリ 参考リンク       試したアクション   GITHUB PROJECT...","postType":"post","thumbnail":"https://technote.space/uploads/2019/08/github-actions.png","createdAt":"2019-09-07T20:30:44.000Z","updatedAt":null},"headerPages":[],"footerPages":[{"label":"About","url":"/pages/wpxml-about/"},{"label":"プライバシーポリシー","url":"/pages/wpxml-privacy-policy/"},{"label":"お問い合わせ","url":"/pages/wpxml-contact/"}]},"__N_SSG":true}